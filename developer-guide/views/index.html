<!doctype html><html lang=en class=no-js><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Learn about Views, one of the core concepts for building UIs in Lite XL."><meta name=author content="takase1121 <20792268+takase1121@users.noreply.github.com>"><link rel=canonical href=https://takase1121.github.io/lite-xl-docs/developer-guide/views/><link rel=prev href=../documents/><link rel=next href=../background-tasks/><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.44"><title>Views - Lite XL</title>
<link rel=stylesheet href=../../assets/stylesheets/main.0253249f.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=stylesheet href=../../stylesheets/extra.a58208.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,t)=>(e<<5)-e+t.charCodeAt(0),0),__md_get=(e,t=localStorage,n=__md_scope)=>JSON.parse(t.getItem(n.pathname+"."+e)),__md_set=(e,t,n=localStorage,s=__md_scope)=>{try{n.setItem(s.pathname+"."+e,JSON.stringify(t))}catch{}}</script><meta property="og:type" content="website"><meta property="og:title" content="Views - Lite XL"><meta property="og:description" content="Learn about Views, one of the core concepts for building UIs in Lite XL."><meta property="og:image" content="https://takase1121.github.io/lite-xl-docs/assets/images/social/developer-guide/views.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="og:url" content="https://takase1121.github.io/lite-xl-docs/developer-guide/views/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Views - Lite XL"><meta name=twitter:description content="Learn about Views, one of the core concepts for building UIs in Lite XL."><meta name=twitter:image content="https://takase1121.github.io/lite-xl-docs/assets/images/social/developer-guide/views.png"><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>html.glightbox-open{overflow:initial;height:100%}.gslide-title{margin-top:0;user-select:text}.gslide-desc{color:#666;user-select:text}.gslide-image img{background:#fff}.gscrollbar-fixer{padding-right:15px}.gdesc-inner{font-size:.75rem}body[data-md-color-scheme=slate] .gdesc-inner{background:var(--md-default-bg-color)}body[data-md-color-scheme=slate] .gslide-title{color:var(--md-default-fg-color)}body[data-md-color-scheme=slate] .gslide-desc{color:var(--md-default-fg-color)}</style><script src=../../assets/javascripts/glightbox.min.js></script><body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo><input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off>
<input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off>
<label class=md-overlay for=__drawer></label><div data-md-component=skip><a href=#creation class=md-skip>Skip to content</a></div><div data-md-component=announce></div><div data-md-color-scheme=default data-md-component=outdated hidden></div><header class=md-header data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a href=../.. title="Lite XL" class="md-header__button md-logo" aria-label="Lite XL" data-md-component=logo><img src=../../assets/icon.svg alt=logo>
</a><label class="md-header__button md-icon" for=__drawer><svg viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis>Lite XL</span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis>Views</span></div></div></div><form class=md-header__option data-md-component=palette><input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0>
<label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg viewBox="0 0 24 24"><path d="M12 8a4 4 0 00-4 4 4 4 0 004 4 4 4 0 004-4 4 4 0 00-4-4m0 10a6 6 0 01-6-6 6 6 0 016-6 6 6 0 016 6 6 6 0 01-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
</label><input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1>
<label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg viewBox="0 0 24 24"><path d="M12 18c-.89.0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 016 6 6 6 0 01-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg></label></form><script>if(palette=__md_get("__palette"),palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var palette,key,value,media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5.0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52.0 019.5 16 6.5 6.5.0 013 9.5 6.5 6.5.0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required>
<label class="md-search__icon md-icon" for=__search><svg viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5.0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52.0 019.5 16 6.5 6.5.0 013 9.5 6.5 6.5.0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg><svg viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg></label><nav class=md-search__options aria-label=Search><button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1><svg viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button></nav></form><div class=md-search__output><div class=md-search__scrollwrap tabindex=0 data-md-scrollfix><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>Initializing search</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a href=https://github.com/takase1121/lite-xl-docs title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87.0 00-40.81.0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34.0 01-48.55.0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86.0 000 40.81l195.61 195.6a28.86 28.86.0 0040.8.0l194.69-194.69a28.86 28.86.0 000-40.81"/></svg></div><div class=md-source__repository>GitHub</div></a></div></nav></header><div class=md-container data-md-component=container><nav class=md-tabs aria-label=Tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a href=../.. class=md-tabs__link>Home</a><li class=md-tabs__item><a href=../../setup/getting-started/ class=md-tabs__link>Set Up</a><li class=md-tabs__item><a href=../../user-guide/introduction/ class=md-tabs__link>User Guide</a><li class="md-tabs__item md-tabs__item--active"><a href=../introduction/ class=md-tabs__link>Developer Guide</a><li class=md-tabs__item><a href=../../about/contributors/ class=md-tabs__link>About</a></ul></div></nav><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a href=../.. title="Lite XL" class="md-nav__button md-logo" aria-label="Lite XL" data-md-component=logo><img src=../../assets/icon.svg alt=logo>
</a>Lite XL</label><div class=md-nav__source><a href=https://github.com/takase1121/lite-xl-docs title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87.0 00-40.81.0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34.0 01-48.55.0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86.0 000 40.81l195.61 195.6a28.86 28.86.0 0040.8.0l194.69-194.69a28.86 28.86.0 000-40.81"/></svg></div><div class=md-source__repository>GitHub</div></a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../.. class=md-nav__link><span class=md-ellipsis>Home</span></a><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" type=checkbox id=__nav_2>
<label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0><span class=md-ellipsis>Set Up
</span><span class="md-nav__icon md-icon"></span></label><nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false><label class=md-nav__title for=__nav_2><span class="md-nav__icon md-icon"></span>
Set Up</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../../setup/getting-started/ class=md-nav__link><span class=md-ellipsis>Getting Started</span></a><li class=md-nav__item><a href=../../setup/install-from-package-managers/ class=md-nav__link><span class=md-ellipsis>Install from Package Managers</span></a><li class=md-nav__item><a href=../../setup/building-from-source/ class=md-nav__link><span class=md-ellipsis>Building from Source</span></a><li class=md-nav__item><a href=../../setup/platform-notes/ class=md-nav__link><span class=md-ellipsis>Platform-Specific Notes</span></a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" type=checkbox id=__nav_3>
<label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0><span class=md-ellipsis>User Guide
</span><span class="md-nav__icon md-icon"></span></label><nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false><label class=md-nav__title for=__nav_3><span class="md-nav__icon md-icon"></span>
User Guide</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../../user-guide/introduction/ class=md-nav__link><span class=md-ellipsis>Introduction</span></a><li class=md-nav__item><a href=../../user-guide/configuration/ class=md-nav__link><span class=md-ellipsis>Configuration</span></a><li class=md-nav__item><a href=../../user-guide/managing-plugins/ class=md-nav__link><span class=md-ellipsis>Managing Plugins</span></a><li class=md-nav__item><a href=../../user-guide/ide-setup/ class=md-nav__link><span class=md-ellipsis>IDE Setup</span></a><li class=md-nav__item><a href=../../user-guide/lsp/ class=md-nav__link><span class=md-ellipsis>Language Server support</span></a><li class=md-nav__item><a href=../../user-guide/keymap/ class=md-nav__link><span class=md-ellipsis>Keymap</span></a><li class=md-nav__item><a href=../../user-guide/macos-keymap/ class=md-nav__link><span class=md-ellipsis>macOS Keymap</span></a></ul></nav><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" type=checkbox id=__nav_4 checked>
<label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex><span class=md-ellipsis>Developer Guide
</span><span class="md-nav__icon md-icon"></span></label><nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true><label class=md-nav__title for=__nav_4><span class="md-nav__icon md-icon"></span>
Developer Guide</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../introduction/ class=md-nav__link><span class=md-ellipsis>Introduction</span></a><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" type=checkbox id=__nav_4_2>
<label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0><span class=md-ellipsis>Syntaxes and Themes
</span><span class="md-nav__icon md-icon"></span></label><nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false><label class=md-nav__title for=__nav_4_2><span class="md-nav__icon md-icon"></span>
Syntaxes and Themes</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../creating-syntaxes/ class=md-nav__link><span class=md-ellipsis>Creating Syntaxes</span></a><li class=md-nav__item><a href=../creating-themes/ class=md-nav__link><span class=md-ellipsis>Creating Themes</span></a></ul></nav><li class=md-nav__item><a href=../commands/ class=md-nav__link><span class=md-ellipsis>Commands</span></a><li class=md-nav__item><a href=../managing-keyboard-shortcuts/ class=md-nav__link><span class=md-ellipsis>Managing Keyboard Shortcuts</span></a><li class=md-nav__item><a href=../classes-and-objects/ class=md-nav__link><span class=md-ellipsis>Classes and Objects</span></a><li class=md-nav__item><a href=../documents/ class=md-nav__link><span class=md-ellipsis>Documents</span></a><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" type=checkbox id=__toc>
<label class="md-nav__link md-nav__link--active" for=__toc><span class=md-ellipsis>Views
</span><span class="md-nav__icon md-icon"></span>
</label><a href=./ class="md-nav__link md-nav__link--active"><span class=md-ellipsis>Views</span></a><nav class="md-nav md-nav--secondary" aria-label="Table of contents"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span>
Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a href=#creation class=md-nav__link><span class=md-ellipsis>Creation</span></a><li class=md-nav__item><a href=#size-position-and-scrolling class=md-nav__link><span class=md-ellipsis>Size, position and scrolling</span></a><li class=md-nav__item><a href=#rendering class=md-nav__link><span class=md-ellipsis>Rendering</span></a><li class=md-nav__item><a href=#events class=md-nav__link><span class=md-ellipsis>Events</span></a><nav class=md-nav aria-label=Events><ul class=md-nav__list><li class=md-nav__item><a href=#periodic-updates class=md-nav__link><span class=md-ellipsis>Periodic updates</span></a><li class=md-nav__item><a href=#mouse class=md-nav__link><span class=md-ellipsis>Mouse</span></a><li class=md-nav__item><a href=#text-input class=md-nav__link><span class=md-ellipsis>Text Input</span></a></ul></nav><li class=md-nav__item><a href=#layout class=md-nav__link><span class=md-ellipsis>Layout</span></a><nav class=md-nav aria-label=Layout><ul class=md-nav__list><li class=md-nav__item><a href=#adding-views-to-the-layout class=md-nav__link><span class=md-ellipsis>Adding Views to the layout</span></a><li class=md-nav__item><a href=#remove-views class=md-nav__link><span class=md-ellipsis>Remove Views</span></a></ul></nav><li class=md-nav__item><a href=#overlays class=md-nav__link><span class=md-ellipsis>Overlays</span></a></ul></nav><li class=md-nav__item><a href=../background-tasks/ class=md-nav__link><span class=md-ellipsis>Background Tasks</span></a><li class=md-nav__item><a href=../debugging/ class=md-nav__link><span class=md-ellipsis>Debugging</span></a><li class=md-nav__item><a href=../using-regular-expressions/ class=md-nav__link><span class=md-ellipsis>Using Regular Expressions</span></a><li class=md-nav__item><a href=../interacting-with-the-os/ class=md-nav__link><span class=md-ellipsis>Interacting with the OS</span></a><li class=md-nav__item><a href=../child-processes/ class=md-nav__link><span class=md-ellipsis>Child Processes</span></a><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" type=checkbox id=__nav_4_13>
<label class=md-nav__link for=__nav_4_13 id=__nav_4_13_label tabindex=0><span class=md-ellipsis>Samples
</span><span class="md-nav__icon md-icon"></span></label><nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_13_label aria-expanded=false><label class=md-nav__title for=__nav_4_13><span class="md-nav__icon md-icon"></span>
Samples</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../simple-plugin/ class=md-nav__link><span class=md-ellipsis>Simple Plugin</span></a><li class=md-nav__item><a href=../views-toolbarview/ class=md-nav__link><span class=md-ellipsis>ToolbarView</span></a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" type=checkbox id=__nav_4_14>
<label class=md-nav__link for=__nav_4_14 id=__nav_4_14_label tabindex=0><span class=md-ellipsis>Advanced Topics
</span><span class="md-nav__icon md-icon"></span></label><nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_14_label aria-expanded=false><label class=md-nav__title for=__nav_4_14><span class="md-nav__icon md-icon"></span>
Advanced Topics</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../renderer-internals/ class=md-nav__link><span class=md-ellipsis>How Renderer Works</span></a></ul></nav></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" type=checkbox id=__nav_5>
<label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0><span class=md-ellipsis>About
</span><span class="md-nav__icon md-icon"></span></label><nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false><label class=md-nav__title for=__nav_5><span class="md-nav__icon md-icon"></span>
About</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../../about/contributors/ class=md-nav__link><span class=md-ellipsis>Contributors</span></a><li class=md-nav__item><a href=../../about/faq/ class=md-nav__link><span class=md-ellipsis>FAQ</span></a></ul></nav></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--secondary" aria-label="Table of contents"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span>
Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a href=#creation class=md-nav__link><span class=md-ellipsis>Creation</span></a><li class=md-nav__item><a href=#size-position-and-scrolling class=md-nav__link><span class=md-ellipsis>Size, position and scrolling</span></a><li class=md-nav__item><a href=#rendering class=md-nav__link><span class=md-ellipsis>Rendering</span></a><li class=md-nav__item><a href=#events class=md-nav__link><span class=md-ellipsis>Events</span></a><nav class=md-nav aria-label=Events><ul class=md-nav__list><li class=md-nav__item><a href=#periodic-updates class=md-nav__link><span class=md-ellipsis>Periodic updates</span></a><li class=md-nav__item><a href=#mouse class=md-nav__link><span class=md-ellipsis>Mouse</span></a><li class=md-nav__item><a href=#text-input class=md-nav__link><span class=md-ellipsis>Text Input</span></a></ul></nav><li class=md-nav__item><a href=#layout class=md-nav__link><span class=md-ellipsis>Layout</span></a><nav class=md-nav aria-label=Layout><ul class=md-nav__list><li class=md-nav__item><a href=#adding-views-to-the-layout class=md-nav__link><span class=md-ellipsis>Adding Views to the layout</span></a><li class=md-nav__item><a href=#remove-views class=md-nav__link><span class=md-ellipsis>Remove Views</span></a></ul></nav><li class=md-nav__item><a href=#overlays class=md-nav__link><span class=md-ellipsis>Overlays</span></a></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><a href=https://github.com/takase1121/lite-xl-docs/edit/master/docs/developer-guide/views.md title="Edit this page" class="md-content__button md-icon"><svg viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1.0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1.0.3.1.4.2l1.3 1.3c.2.2.2.6.0.8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
</a><a href=https://github.com/takase1121/lite-xl-docs/raw/master/docs/developer-guide/views.md title="View source of this page" class="md-content__button md-icon"><svg viewBox="0 0 24 24"><path d="M17 18c.56.0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73.0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5A2.5 2.5.0 0114.5 19a2.5 2.5.0 012.5-2.5 2.5 2.5.0 012.5 2.5A2.5 2.5.0 0117 21.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6A2 2 0 004 4v16a2 2 0 002 2h4.5a8.2 8.2.0 01-1.23-2"/></svg></a><h1>Views</h1><p>Lite XL has the concept of Views and Nodes.
Views in Lite XL is organized into binary tree, with each leaf node containing one or more Views.
A branch can either split vertically or horizontally.<p>A View is a UI component used to display content to the end user.
As such, a View contains methods for event handling, state management and rendering.<h2 id=creation>Creation</h2><p>A View can be created by extending the <code>View</code> class.
The <code>View</code> class contains many important states and provides convenience methods for handling events.<p>After that, you can create instances of Views and add them to a Node.<p>For example, we'll create a View called <code>HelloView</code>.<div class=highlight><pre><span></span><code><a id=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1>-- mod-version:3</span>
<a id=__codelineno-0-2 href=#__codelineno-0-2></a><span class=kd>local</span> <span class=n>core</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core&quot;</span>
<a id=__codelineno-0-3 href=#__codelineno-0-3></a><span class=kd>local</span> <span class=n>command</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.command&quot;</span>
<a id=__codelineno-0-4 href=#__codelineno-0-4></a><span class=kd>local</span> <span class=n>common</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.common&quot;</span>
<a id=__codelineno-0-5 href=#__codelineno-0-5></a><span class=kd>local</span> <span class=n>style</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.style&quot;</span>
<a id=__codelineno-0-6 href=#__codelineno-0-6></a>
<a id=__codelineno-0-7 href=#__codelineno-0-7></a><span class=kd>local</span> <span class=n>View</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.view&quot;</span>
<a id=__codelineno-0-8 href=#__codelineno-0-8></a>
<a id=__codelineno-0-9 href=#__codelineno-0-9></a><span class=kd>local</span> <span class=n>HelloView</span> <span class=o>=</span> <span class=n>View</span><span class=p>:</span><span class=n>extend</span><span class=p>()</span>
<a id=__codelineno-0-10 href=#__codelineno-0-10></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>new</span><span class=p>()</span>
<a id=__codelineno-0-11 href=#__codelineno-0-11></a>  <span class=c1>-- This is the constructor for HelloView.</span>
<a id=__codelineno-0-12 href=#__codelineno-0-12></a>  <span class=c1>-- Here, we&#39;ll call View&#39;s constructor to initialize</span>
<a id=__codelineno-0-13 href=#__codelineno-0-13></a>  <span class=c1>-- some important states.</span>
<a id=__codelineno-0-14 href=#__codelineno-0-14></a>  <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>new</span><span class=p>(</span><span class=n>self</span><span class=p>)</span>
<a id=__codelineno-0-15 href=#__codelineno-0-15></a>  <span class=c1>-- This can be &quot;session&quot; or &quot;application&quot;</span>
<a id=__codelineno-0-16 href=#__codelineno-0-16></a>  <span class=c1>-- If you specify &quot;application&quot;, then the View will</span>
<a id=__codelineno-0-17 href=#__codelineno-0-17></a>  <span class=c1>-- not be closed when the user performs &quot;root:close-all&quot;.</span>
<a id=__codelineno-0-18 href=#__codelineno-0-18></a>  <span class=c1>-- The user must explicitly close this View.</span>
<a id=__codelineno-0-19 href=#__codelineno-0-19></a>  <span class=n>self</span><span class=p>.</span><span class=n>context</span> <span class=o>=</span> <span class=s2>&quot;session&quot;</span>
<a id=__codelineno-0-20 href=#__codelineno-0-20></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption</span> <span class=o>=</span> <span class=s2>&quot;Hello world!&quot;</span>
<a id=__codelineno-0-21 href=#__codelineno-0-21></a><span class=kr>end</span>
<a id=__codelineno-0-22 href=#__codelineno-0-22></a>
<a id=__codelineno-0-23 href=#__codelineno-0-23></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_name</span><span class=p>()</span>
<a id=__codelineno-0-24 href=#__codelineno-0-24></a>  <span class=c1>-- Returns the display name of the View.</span>
<a id=__codelineno-0-25 href=#__codelineno-0-25></a>  <span class=c1>-- If tabs are enabled, this will be displayed as the tab title.</span>
<a id=__codelineno-0-26 href=#__codelineno-0-26></a>  <span class=kr>return</span> <span class=s2>&quot;Hello!&quot;</span>
<a id=__codelineno-0-27 href=#__codelineno-0-27></a><span class=kr>end</span>
<a id=__codelineno-0-28 href=#__codelineno-0-28></a>
<a id=__codelineno-0-29 href=#__codelineno-0-29></a><span class=c1>-- Add a command to create a View.</span>
<a id=__codelineno-0-30 href=#__codelineno-0-30></a><span class=n>command</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=p>{</span>
<a id=__codelineno-0-31 href=#__codelineno-0-31></a>  <span class=p>[</span><span class=s2>&quot;hello:hello&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kr>function</span><span class=p>()</span>
<a id=__codelineno-0-32 href=#__codelineno-0-32></a>    <span class=c1>-- We&#39;ll get the current active node and add a view to it.</span>
<a id=__codelineno-0-33 href=#__codelineno-0-33></a>    <span class=c1>-- This will usually create a new tab.</span>
<a id=__codelineno-0-34 href=#__codelineno-0-34></a>    <span class=n>core</span><span class=p>.</span><span class=n>root_view</span><span class=p>:</span><span class=n>get_active_node</span><span class=p>():</span><span class=n>add_view</span><span class=p>(</span><span class=n>HelloView</span><span class=p>())</span>
<a id=__codelineno-0-35 href=#__codelineno-0-35></a>  <span class=kr>end</span>
<a id=__codelineno-0-36 href=#__codelineno-0-36></a><span class=p>})</span>
</code></pre></div><p>Currently, this plugin will do nothing.
You won't see anything because the View doesn't have a draw function.<h2 id=size-position-and-scrolling>Size, position and scrolling</h2><p>A View can be thought of as a stencil on canvas.
Everything drawn within the View dimension will be shown to the user,
while everything drawn outside the View are discarded.
This ties into how Lite XL handles scrolling — the canvas is moved around instead of the stencil.<p>The size of a View (the stencil) is stored in <code>View.size.x</code> and <code>View.size.y</code>.
These are the size of the stencil following our analogy.
The size of the canvas is computed by calling <code>View:get_scrollable_size()</code> and <code>View:get_h_scrollable_size()</code>.
These methods can return a value larger than the View size to enable scrolling
or very huge numbers that represents an infinitely scrollable View.<p>The position of the View relative to the window is stored in <code>View.position</code>.
Following our analogy, these values represent where to place the stencil.
In reality, these values are rarely used directly as values
returned by <code>View:get_content_offset()</code> is more useful.<p>If a View is scrollable, you should set <code>View.scrollable</code> to <code>true</code> and override <code>View:get_scrollable_size()</code>
and <code>View:get_h_scrollable_size()</code>.
You should also call <code>View:draw_scrollbar()</code> in your draw method to render Lite XL's scrollbar for convenience.<p>When a View is scrollable, <code>View:get_content_offset()</code> can be used to determine where to start drawing.
This method returns starting X and Y coordinates, which may be negative
to represent hidden content above the View; or larger View size to represent hidden content after the View.<p>The scroll state of the View is stored in <code>View.scroll</code>.
This table contains the X and Y offset when the view is scrolled.
To simulate scrolling, you can change the value of <code>View.scroll.to.x</code> or <code>View.scroll.to.y</code>.
A positive value will scroll right / down while a negative value scrolls left / up.
Alternatively, you may change <code>View.scroll.x</code> or <code>View.scroll.y</code> directly.<p>In our example, we'll implement horizontal and vertical scrolling.
The surface size is double our View size.<div class=highlight><pre><span></span><code><a id=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1>-- mod-version:3</span>
<a id=__codelineno-1-2 href=#__codelineno-1-2></a><span class=kd>local</span> <span class=n>core</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core&quot;</span>
<a id=__codelineno-1-3 href=#__codelineno-1-3></a><span class=kd>local</span> <span class=n>command</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.command&quot;</span>
<a id=__codelineno-1-4 href=#__codelineno-1-4></a><span class=kd>local</span> <span class=n>common</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.common&quot;</span>
<a id=__codelineno-1-5 href=#__codelineno-1-5></a><span class=kd>local</span> <span class=n>style</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.style&quot;</span>
<a id=__codelineno-1-6 href=#__codelineno-1-6></a>
<a id=__codelineno-1-7 href=#__codelineno-1-7></a><span class=kd>local</span> <span class=n>View</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.view&quot;</span>
<a id=__codelineno-1-8 href=#__codelineno-1-8></a>
<a id=__codelineno-1-9 href=#__codelineno-1-9></a><span class=kd>local</span> <span class=n>HelloView</span> <span class=o>=</span> <span class=n>View</span><span class=p>:</span><span class=n>extend</span><span class=p>()</span>
<a id=__codelineno-1-10 href=#__codelineno-1-10></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>new</span><span class=p>()</span>
<a id=__codelineno-1-11 href=#__codelineno-1-11></a>  <span class=c1>-- This is the constructor for HelloView.</span>
<a id=__codelineno-1-12 href=#__codelineno-1-12></a>  <span class=c1>-- Here, we&#39;ll call View&#39;s constructor to initialize</span>
<a id=__codelineno-1-13 href=#__codelineno-1-13></a>  <span class=c1>-- some important states.</span>
<a id=__codelineno-1-14 href=#__codelineno-1-14></a>  <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>new</span><span class=p>(</span><span class=n>self</span><span class=p>)</span>
<a id=__codelineno-1-15 href=#__codelineno-1-15></a>  <span class=c1>-- set a caption that we&#39;ll use later</span>
<a id=__codelineno-1-16 href=#__codelineno-1-16></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption</span> <span class=o>=</span> <span class=s2>&quot;Hello world!&quot;</span>
<a id=__codelineno-1-17 href=#__codelineno-1-17></a>  <span class=n>self</span><span class=p>.</span><span class=n>scrollable</span> <span class=o>=</span> <span class=kc>true</span>
<a id=__codelineno-1-18 href=#__codelineno-1-18></a><span class=kr>end</span>
<a id=__codelineno-1-19 href=#__codelineno-1-19></a>
<a id=__codelineno-1-20 href=#__codelineno-1-20></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_name</span><span class=p>()</span>
<a id=__codelineno-1-21 href=#__codelineno-1-21></a>  <span class=c1>-- Returns the display name of the View.</span>
<a id=__codelineno-1-22 href=#__codelineno-1-22></a>  <span class=c1>-- If tabs are enabled, this will be displayed as the tab title.</span>
<a id=__codelineno-1-23 href=#__codelineno-1-23></a>  <span class=kr>return</span> <span class=s2>&quot;Hello!&quot;</span>
<a id=__codelineno-1-24 href=#__codelineno-1-24></a><span class=kr>end</span>
<a id=__codelineno-1-25 href=#__codelineno-1-25></a>
<a id=__codelineno-1-26 href=#__codelineno-1-26></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_scrollable_size</span><span class=p>()</span>
<a id=__codelineno-1-27 href=#__codelineno-1-27></a>  <span class=c1>-- the &quot;actual&quot; height of the View</span>
<a id=__codelineno-1-28 href=#__codelineno-1-28></a>  <span class=kr>return</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-1-29 href=#__codelineno-1-29></a><span class=kr>end</span>
<a id=__codelineno-1-30 href=#__codelineno-1-30></a>
<a id=__codelineno-1-31 href=#__codelineno-1-31></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_h_scrollable_size</span><span class=p>()</span>
<a id=__codelineno-1-32 href=#__codelineno-1-32></a>  <span class=c1>-- the &quot;actual&quot; width of the View</span>
<a id=__codelineno-1-33 href=#__codelineno-1-33></a>  <span class=kr>return</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>x</span>
<a id=__codelineno-1-34 href=#__codelineno-1-34></a><span class=kr>end</span>
<a id=__codelineno-1-35 href=#__codelineno-1-35></a>
<a id=__codelineno-1-36 href=#__codelineno-1-36></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>draw</span><span class=p>()</span>
<a id=__codelineno-1-37 href=#__codelineno-1-37></a>  <span class=c1>-- You should call this to avoid overdrawing</span>
<a id=__codelineno-1-38 href=#__codelineno-1-38></a>  <span class=c1>-- previous content.</span>
<a id=__codelineno-1-39 href=#__codelineno-1-39></a>  <span class=n>self</span><span class=p>:</span><span class=n>draw_background</span><span class=p>(</span><span class=n>style</span><span class=p>.</span><span class=n>background</span><span class=p>)</span>
<a id=__codelineno-1-40 href=#__codelineno-1-40></a>  <span class=c1>-- Draw the scrollbar</span>
<a id=__codelineno-1-41 href=#__codelineno-1-41></a>  <span class=n>self</span><span class=p>:</span><span class=n>draw_scrollbar</span><span class=p>()</span>
<a id=__codelineno-1-42 href=#__codelineno-1-42></a><span class=kr>end</span>
<a id=__codelineno-1-43 href=#__codelineno-1-43></a>
<a id=__codelineno-1-44 href=#__codelineno-1-44></a><span class=c1>-- Add a command to create a View.</span>
<a id=__codelineno-1-45 href=#__codelineno-1-45></a><span class=n>command</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=p>{</span>
<a id=__codelineno-1-46 href=#__codelineno-1-46></a>  <span class=p>[</span><span class=s2>&quot;hello:hello&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kr>function</span><span class=p>()</span>
<a id=__codelineno-1-47 href=#__codelineno-1-47></a>    <span class=c1>-- We&#39;ll get the current active node and add a view to it.</span>
<a id=__codelineno-1-48 href=#__codelineno-1-48></a>    <span class=c1>-- This will usually create a new tab.</span>
<a id=__codelineno-1-49 href=#__codelineno-1-49></a>    <span class=n>core</span><span class=p>.</span><span class=n>root_view</span><span class=p>:</span><span class=n>get_active_node</span><span class=p>():</span><span class=n>add_view</span><span class=p>(</span><span class=n>HelloView</span><span class=p>())</span>
<a id=__codelineno-1-50 href=#__codelineno-1-50></a>  <span class=kr>end</span>
<a id=__codelineno-1-51 href=#__codelineno-1-51></a><span class=p>})</span>
</code></pre></div><p>You should end up with a View that is scrollable but has nothing in it.
We're going to draw something in the next section.<h2 id=rendering>Rendering</h2><p>The most important method of a view is <code>View:render()</code>.
This function is called when Lite XL wants to render something.<p>As mentioned before, you can draw anywhere on the screen,
but only the contents within the View is shown to the user.
This is implemented by <code>Node.draw()</code> setting the clip rectangle to the dimensions of the View.<p>In our example, we're going to draw the caption we've set in the constructor.<div class=highlight><pre><span></span><code><a id=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1>-- mod-version:3</span>
<a id=__codelineno-2-2 href=#__codelineno-2-2></a><span class=kd>local</span> <span class=n>core</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core&quot;</span>
<a id=__codelineno-2-3 href=#__codelineno-2-3></a><span class=kd>local</span> <span class=n>command</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.command&quot;</span>
<a id=__codelineno-2-4 href=#__codelineno-2-4></a><span class=kd>local</span> <span class=n>common</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.common&quot;</span>
<a id=__codelineno-2-5 href=#__codelineno-2-5></a><span class=kd>local</span> <span class=n>style</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.style&quot;</span>
<a id=__codelineno-2-6 href=#__codelineno-2-6></a>
<a id=__codelineno-2-7 href=#__codelineno-2-7></a><span class=kd>local</span> <span class=n>View</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.view&quot;</span>
<a id=__codelineno-2-8 href=#__codelineno-2-8></a>
<a id=__codelineno-2-9 href=#__codelineno-2-9></a><span class=kd>local</span> <span class=n>HelloView</span> <span class=o>=</span> <span class=n>View</span><span class=p>:</span><span class=n>extend</span><span class=p>()</span>
<a id=__codelineno-2-10 href=#__codelineno-2-10></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>new</span><span class=p>()</span>
<a id=__codelineno-2-11 href=#__codelineno-2-11></a>  <span class=c1>-- This is the constructor for HelloView.</span>
<a id=__codelineno-2-12 href=#__codelineno-2-12></a>  <span class=c1>-- Here, we&#39;ll call View&#39;s constructor to initialize</span>
<a id=__codelineno-2-13 href=#__codelineno-2-13></a>  <span class=c1>-- some important states.</span>
<a id=__codelineno-2-14 href=#__codelineno-2-14></a>  <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>new</span><span class=p>(</span><span class=n>self</span><span class=p>)</span>
<a id=__codelineno-2-15 href=#__codelineno-2-15></a>  <span class=c1>-- set a caption that we&#39;ll use later</span>
<a id=__codelineno-2-16 href=#__codelineno-2-16></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption</span> <span class=o>=</span> <span class=s2>&quot;Hello world!&quot;</span>
<a id=__codelineno-2-17 href=#__codelineno-2-17></a>  <span class=n>self</span><span class=p>.</span><span class=n>scrollable</span> <span class=o>=</span> <span class=kc>true</span>
<a id=__codelineno-2-18 href=#__codelineno-2-18></a><span class=kr>end</span>
<a id=__codelineno-2-19 href=#__codelineno-2-19></a>
<a id=__codelineno-2-20 href=#__codelineno-2-20></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_name</span><span class=p>()</span>
<a id=__codelineno-2-21 href=#__codelineno-2-21></a>  <span class=c1>-- Returns the display name of the View.</span>
<a id=__codelineno-2-22 href=#__codelineno-2-22></a>  <span class=c1>-- If tabs are enabled, this will be displayed as the tab title.</span>
<a id=__codelineno-2-23 href=#__codelineno-2-23></a>  <span class=kr>return</span> <span class=s2>&quot;Hello!&quot;</span>
<a id=__codelineno-2-24 href=#__codelineno-2-24></a><span class=kr>end</span>
<a id=__codelineno-2-25 href=#__codelineno-2-25></a>
<a id=__codelineno-2-26 href=#__codelineno-2-26></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_scrollable_size</span><span class=p>()</span>
<a id=__codelineno-2-27 href=#__codelineno-2-27></a>  <span class=c1>-- the &quot;actual&quot; height of the View</span>
<a id=__codelineno-2-28 href=#__codelineno-2-28></a>  <span class=kr>return</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-2-29 href=#__codelineno-2-29></a><span class=kr>end</span>
<a id=__codelineno-2-30 href=#__codelineno-2-30></a>
<a id=__codelineno-2-31 href=#__codelineno-2-31></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_h_scrollable_size</span><span class=p>()</span>
<a id=__codelineno-2-32 href=#__codelineno-2-32></a>  <span class=c1>-- the &quot;actual&quot; width of the View</span>
<a id=__codelineno-2-33 href=#__codelineno-2-33></a>  <span class=kr>return</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>x</span>
<a id=__codelineno-2-34 href=#__codelineno-2-34></a><span class=kr>end</span>
<a id=__codelineno-2-35 href=#__codelineno-2-35></a>
<a id=__codelineno-2-36 href=#__codelineno-2-36></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>draw</span><span class=p>()</span>
<a id=__codelineno-2-37 href=#__codelineno-2-37></a>  <span class=c1>-- You should call this to avoid overdrawing</span>
<a id=__codelineno-2-38 href=#__codelineno-2-38></a>  <span class=c1>-- previous content.</span>
<a id=__codelineno-2-39 href=#__codelineno-2-39></a>  <span class=n>self</span><span class=p>:</span><span class=n>draw_background</span><span class=p>(</span><span class=n>style</span><span class=p>.</span><span class=n>background</span><span class=p>)</span>
<a id=__codelineno-2-40 href=#__codelineno-2-40></a>  <span class=c1>-- Get the top-left corner of the View</span>
<a id=__codelineno-2-41 href=#__codelineno-2-41></a>  <span class=kd>local</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>self</span><span class=p>:</span><span class=n>get_content_offset</span><span class=p>()</span>
<a id=__codelineno-2-42 href=#__codelineno-2-42></a>  <span class=c1>-- We&#39;ll use view.size here so that looks centered</span>
<a id=__codelineno-2-43 href=#__codelineno-2-43></a>  <span class=c1>-- At the start.</span>
<a id=__codelineno-2-44 href=#__codelineno-2-44></a>  <span class=kd>local</span> <span class=n>w</span><span class=p>,</span> <span class=n>h</span> <span class=o>=</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-2-45 href=#__codelineno-2-45></a>  <span class=c1>-- Draw the caption with common.draw_text().</span>
<a id=__codelineno-2-46 href=#__codelineno-2-46></a>  <span class=c1>-- This function provides some utilities such as alignment</span>
<a id=__codelineno-2-47 href=#__codelineno-2-47></a>  <span class=c1>-- over renderer.draw_text().</span>
<a id=__codelineno-2-48 href=#__codelineno-2-48></a>  <span class=n>common</span><span class=p>.</span><span class=n>draw_text</span><span class=p>(</span><span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>,</span> <span class=n>style</span><span class=p>.</span><span class=n>text</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>caption</span><span class=p>,</span> <span class=s2>&quot;center&quot;</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>h</span><span class=p>)</span>
<a id=__codelineno-2-49 href=#__codelineno-2-49></a>  <span class=c1>-- Draw the scrollbar</span>
<a id=__codelineno-2-50 href=#__codelineno-2-50></a>  <span class=n>self</span><span class=p>:</span><span class=n>draw_scrollbar</span><span class=p>()</span>
<a id=__codelineno-2-51 href=#__codelineno-2-51></a><span class=kr>end</span>
<a id=__codelineno-2-52 href=#__codelineno-2-52></a>
<a id=__codelineno-2-53 href=#__codelineno-2-53></a><span class=c1>-- Add a command to create a View.</span>
<a id=__codelineno-2-54 href=#__codelineno-2-54></a><span class=n>command</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=p>{</span>
<a id=__codelineno-2-55 href=#__codelineno-2-55></a>  <span class=p>[</span><span class=s2>&quot;hello:hello&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kr>function</span><span class=p>()</span>
<a id=__codelineno-2-56 href=#__codelineno-2-56></a>    <span class=c1>-- We&#39;ll get the current active node and add a view to it.</span>
<a id=__codelineno-2-57 href=#__codelineno-2-57></a>    <span class=c1>-- This will usually create a new tab.</span>
<a id=__codelineno-2-58 href=#__codelineno-2-58></a>    <span class=n>core</span><span class=p>.</span><span class=n>root_view</span><span class=p>:</span><span class=n>get_active_node</span><span class=p>():</span><span class=n>add_view</span><span class=p>(</span><span class=n>HelloView</span><span class=p>())</span>
<a id=__codelineno-2-59 href=#__codelineno-2-59></a>  <span class=kr>end</span>
<a id=__codelineno-2-60 href=#__codelineno-2-60></a><span class=p>})</span>
</code></pre></div><p>You should end up with some text drawn in the center of the screen.
In the next section, we'll make it more interesting.<div class="admonition warning"><p class=admonition-title>Never draw anything outside the render method.<p>The render method is called after renderer.begin_frame().
Any draw calls before this function will be discarded.</div><h2 id=events>Events</h2><p>Views have several methods to handle events.
Events are usually propagated from the top (RootView) to the bottom.
Event handlers are usually called <code>on_&lt;event_name></code> except <code>update</code>.
You can override these methods to provide your own handler logic.
Some events require you to return <code>true</code> to indicate that the event is handled
and should not be propagated further.<h3 id=periodic-updates>Periodic updates</h3><p>The <code>update</code> event is sent right before Lite XL redraws its UI.
You can use this event to perform some state management among other things.
The handler is called without arguments and should return nothing.<p>In our example, let's extend <code>HelloView</code> by displaying the number of seconds elapsed since Lite XL started.<div class=highlight><pre><span></span><code><a id=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1>-- mod-version:3</span>
<a id=__codelineno-3-2 href=#__codelineno-3-2></a><span class=kd>local</span> <span class=n>core</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core&quot;</span>
<a id=__codelineno-3-3 href=#__codelineno-3-3></a><span class=kd>local</span> <span class=n>command</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.command&quot;</span>
<a id=__codelineno-3-4 href=#__codelineno-3-4></a><span class=kd>local</span> <span class=n>common</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.common&quot;</span>
<a id=__codelineno-3-5 href=#__codelineno-3-5></a><span class=kd>local</span> <span class=n>style</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.style&quot;</span>
<a id=__codelineno-3-6 href=#__codelineno-3-6></a>
<a id=__codelineno-3-7 href=#__codelineno-3-7></a><span class=kd>local</span> <span class=n>View</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.view&quot;</span>
<a id=__codelineno-3-8 href=#__codelineno-3-8></a>
<a id=__codelineno-3-9 href=#__codelineno-3-9></a><span class=kd>local</span> <span class=n>HelloView</span> <span class=o>=</span> <span class=n>View</span><span class=p>:</span><span class=n>extend</span><span class=p>()</span>
<a id=__codelineno-3-10 href=#__codelineno-3-10></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>new</span><span class=p>()</span>
<a id=__codelineno-3-11 href=#__codelineno-3-11></a>  <span class=c1>-- This is the constructor for HelloView.</span>
<a id=__codelineno-3-12 href=#__codelineno-3-12></a>  <span class=c1>-- Here, we&#39;ll call View&#39;s constructor to initialize</span>
<a id=__codelineno-3-13 href=#__codelineno-3-13></a>  <span class=c1>-- some important states.</span>
<a id=__codelineno-3-14 href=#__codelineno-3-14></a>  <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>new</span><span class=p>(</span><span class=n>self</span><span class=p>)</span>
<a id=__codelineno-3-15 href=#__codelineno-3-15></a>  <span class=c1>-- set a caption that we&#39;ll use later</span>
<a id=__codelineno-3-16 href=#__codelineno-3-16></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption</span> <span class=o>=</span> <span class=s2>&quot;Hello world!&quot;</span>
<a id=__codelineno-3-17 href=#__codelineno-3-17></a>  <span class=n>self</span><span class=p>.</span><span class=n>scrollable</span> <span class=o>=</span> <span class=kc>true</span>
<a id=__codelineno-3-18 href=#__codelineno-3-18></a><span class=kr>end</span>
<a id=__codelineno-3-19 href=#__codelineno-3-19></a>
<a id=__codelineno-3-20 href=#__codelineno-3-20></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_name</span><span class=p>()</span>
<a id=__codelineno-3-21 href=#__codelineno-3-21></a>  <span class=c1>-- Returns the display name of the View.</span>
<a id=__codelineno-3-22 href=#__codelineno-3-22></a>  <span class=c1>-- If tabs are enabled, this will be displayed as the tab title.</span>
<a id=__codelineno-3-23 href=#__codelineno-3-23></a>  <span class=kr>return</span> <span class=s2>&quot;Hello!&quot;</span>
<a id=__codelineno-3-24 href=#__codelineno-3-24></a><span class=kr>end</span>
<a id=__codelineno-3-25 href=#__codelineno-3-25></a>
<a id=__codelineno-3-26 href=#__codelineno-3-26></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_scrollable_size</span><span class=p>()</span>
<a id=__codelineno-3-27 href=#__codelineno-3-27></a>  <span class=c1>-- the &quot;actual&quot; height of the View</span>
<a id=__codelineno-3-28 href=#__codelineno-3-28></a>  <span class=kr>return</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-3-29 href=#__codelineno-3-29></a><span class=kr>end</span>
<a id=__codelineno-3-30 href=#__codelineno-3-30></a>
<a id=__codelineno-3-31 href=#__codelineno-3-31></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_h_scrollable_size</span><span class=p>()</span>
<a id=__codelineno-3-32 href=#__codelineno-3-32></a>  <span class=c1>-- the &quot;actual&quot; width of the View</span>
<a id=__codelineno-3-33 href=#__codelineno-3-33></a>  <span class=kr>return</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>x</span>
<a id=__codelineno-3-34 href=#__codelineno-3-34></a><span class=kr>end</span>
<a id=__codelineno-3-35 href=#__codelineno-3-35></a>
<a id=__codelineno-3-36 href=#__codelineno-3-36></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>update</span><span class=p>()</span>
<a id=__codelineno-3-37 href=#__codelineno-3-37></a>  <span class=c1>-- Update some important View states.</span>
<a id=__codelineno-3-38 href=#__codelineno-3-38></a>  <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>update</span><span class=p>(</span><span class=n>self</span><span class=p>)</span>
<a id=__codelineno-3-39 href=#__codelineno-3-39></a>  <span class=c1>-- system.get_time() returns the number of seconds since Lite XL started.</span>
<a id=__codelineno-3-40 href=#__codelineno-3-40></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption</span> <span class=o>=</span> <span class=nb>string.format</span><span class=p>(</span><span class=s2>&quot;Time elapsed: %.2f&quot;</span><span class=p>,</span> <span class=n>system</span><span class=p>.</span><span class=n>get_time</span><span class=p>())</span>
<a id=__codelineno-3-41 href=#__codelineno-3-41></a>  <span class=c1>-- This tells Lite XL that we want to constantly redraw.</span>
<a id=__codelineno-3-42 href=#__codelineno-3-42></a>  <span class=n>core</span><span class=p>.</span><span class=n>redraw</span> <span class=o>=</span> <span class=kc>true</span>
<a id=__codelineno-3-43 href=#__codelineno-3-43></a><span class=kr>end</span>
<a id=__codelineno-3-44 href=#__codelineno-3-44></a>
<a id=__codelineno-3-45 href=#__codelineno-3-45></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>draw</span><span class=p>()</span>
<a id=__codelineno-3-46 href=#__codelineno-3-46></a>  <span class=c1>-- You should call this to avoid overdrawing</span>
<a id=__codelineno-3-47 href=#__codelineno-3-47></a>  <span class=c1>-- previous content.</span>
<a id=__codelineno-3-48 href=#__codelineno-3-48></a>  <span class=n>self</span><span class=p>:</span><span class=n>draw_background</span><span class=p>(</span><span class=n>style</span><span class=p>.</span><span class=n>background</span><span class=p>)</span>
<a id=__codelineno-3-49 href=#__codelineno-3-49></a>  <span class=c1>-- Get the top-left corner of the View</span>
<a id=__codelineno-3-50 href=#__codelineno-3-50></a>  <span class=kd>local</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>self</span><span class=p>:</span><span class=n>get_content_offset</span><span class=p>()</span>
<a id=__codelineno-3-51 href=#__codelineno-3-51></a>  <span class=c1>-- We&#39;ll use view.size here so that looks centered</span>
<a id=__codelineno-3-52 href=#__codelineno-3-52></a>  <span class=c1>-- At the start.</span>
<a id=__codelineno-3-53 href=#__codelineno-3-53></a>  <span class=kd>local</span> <span class=n>w</span><span class=p>,</span> <span class=n>h</span> <span class=o>=</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-3-54 href=#__codelineno-3-54></a>  <span class=c1>-- Draw the caption with common.draw_text().</span>
<a id=__codelineno-3-55 href=#__codelineno-3-55></a>  <span class=c1>-- This function provides some utilities such as alignment</span>
<a id=__codelineno-3-56 href=#__codelineno-3-56></a>  <span class=c1>-- over renderer.draw_text().</span>
<a id=__codelineno-3-57 href=#__codelineno-3-57></a>  <span class=n>common</span><span class=p>.</span><span class=n>draw_text</span><span class=p>(</span><span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>,</span> <span class=n>style</span><span class=p>.</span><span class=n>text</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>caption</span><span class=p>,</span> <span class=s2>&quot;center&quot;</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>h</span><span class=p>)</span>
<a id=__codelineno-3-58 href=#__codelineno-3-58></a>  <span class=c1>-- Draw the scrollbar</span>
<a id=__codelineno-3-59 href=#__codelineno-3-59></a>  <span class=n>self</span><span class=p>:</span><span class=n>draw_scrollbar</span><span class=p>()</span>
<a id=__codelineno-3-60 href=#__codelineno-3-60></a><span class=kr>end</span>
<a id=__codelineno-3-61 href=#__codelineno-3-61></a>
<a id=__codelineno-3-62 href=#__codelineno-3-62></a><span class=c1>-- Add a command to create a View.</span>
<a id=__codelineno-3-63 href=#__codelineno-3-63></a><span class=n>command</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=p>{</span>
<a id=__codelineno-3-64 href=#__codelineno-3-64></a>  <span class=p>[</span><span class=s2>&quot;hello:hello&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kr>function</span><span class=p>()</span>
<a id=__codelineno-3-65 href=#__codelineno-3-65></a>    <span class=c1>-- We&#39;ll get the current active node and add a view to it.</span>
<a id=__codelineno-3-66 href=#__codelineno-3-66></a>    <span class=c1>-- This will usually create a new tab.</span>
<a id=__codelineno-3-67 href=#__codelineno-3-67></a>    <span class=n>core</span><span class=p>.</span><span class=n>root_view</span><span class=p>:</span><span class=n>get_active_node</span><span class=p>():</span><span class=n>add_view</span><span class=p>(</span><span class=n>HelloView</span><span class=p>())</span>
<a id=__codelineno-3-68 href=#__codelineno-3-68></a>  <span class=kr>end</span>
<a id=__codelineno-3-69 href=#__codelineno-3-69></a><span class=p>})</span>
</code></pre></div><div class="admonition tips"><p class=admonition-title>Try commenting out <code>core.redraw = true</code> in the update method.<p>This will cause the timer to freeze as soon as there's no input.
<code>View:update()</code> is only called when Lite XL wants to update the content;
it will not be called when nothing is changed.</div><h3 id=mouse>Mouse</h3><p>The keymap is the go-to way for handling mouse events with keystrokes.
However, if you want to have more control over mouse events, you
can override <code>View:on_mouse_moved()</code>, <code>View:on_mouse_pressed()</code>,
<code>View:on_mouse_released()</code> and <code>View:on_mouse_wheel()</code>.<div class=highlight><pre><span></span><code><a id=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kr>function</span> <span class=nc>View</span><span class=p>:</span><span class=nf>on_mouse_moved</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>number</span><span class=p>,</span>
<a id=__codelineno-4-2 href=#__codelineno-4-2></a>                              <span class=n>y</span><span class=p>:</span> <span class=n>number</span><span class=p>,</span>
<a id=__codelineno-4-3 href=#__codelineno-4-3></a>                              <span class=n>dx</span><span class=p>:</span> <span class=n>number</span><span class=p>,</span>
<a id=__codelineno-4-4 href=#__codelineno-4-4></a>                              <span class=n>dy</span><span class=p>:</span> <span class=n>number</span><span class=p>):</span> <span class=n>boolean</span> <span class=kr>end</span>
<a id=__codelineno-4-5 href=#__codelineno-4-5></a>
<a id=__codelineno-4-6 href=#__codelineno-4-6></a><span class=kr>function</span> <span class=nc>View</span><span class=p>:</span><span class=nf>on_mouse_pressed</span><span class=p>(</span><span class=n>button</span><span class=p>:</span> <span class=n>MouseButton</span><span class=p>,</span>
<a id=__codelineno-4-7 href=#__codelineno-4-7></a>                                <span class=n>x</span><span class=p>:</span> <span class=n>number</span><span class=p>,</span>
<a id=__codelineno-4-8 href=#__codelineno-4-8></a>                                <span class=n>y</span><span class=p>:</span> <span class=n>number</span><span class=p>,</span>
<a id=__codelineno-4-9 href=#__codelineno-4-9></a>                                <span class=n>clicks</span><span class=p>:</span> <span class=n>number</span><span class=p>):</span> <span class=n>boolean</span> <span class=kr>end</span>
<a id=__codelineno-4-10 href=#__codelineno-4-10></a>
<a id=__codelineno-4-11 href=#__codelineno-4-11></a><span class=kr>function</span> <span class=nc>View</span><span class=p>:</span><span class=nf>on_mouse_released</span><span class=p>(</span><span class=n>button</span><span class=p>:</span> <span class=n>MouseButton</span><span class=p>,</span>
<a id=__codelineno-4-12 href=#__codelineno-4-12></a>                                <span class=n>x</span><span class=p>:</span> <span class=n>number</span><span class=p>,</span>
<a id=__codelineno-4-13 href=#__codelineno-4-13></a>                                <span class=n>y</span><span class=p>:</span> <span class=n>number</span><span class=p>):</span> <span class=kc>nil</span> <span class=kr>end</span>
<a id=__codelineno-4-14 href=#__codelineno-4-14></a>
<a id=__codelineno-4-15 href=#__codelineno-4-15></a><span class=kr>function</span> <span class=nc>View</span><span class=p>:</span><span class=nf>on_mouse_wheel</span><span class=p>(</span><span class=n>y</span><span class=p>:</span> <span class=n>number</span><span class=p>,</span> <span class=n>x</span><span class=p>:</span> <span class=n>number</span><span class=p>):</span> <span class=n>boolean</span> <span class=kr>end</span>
</code></pre></div><p><code>View:on_mouse_moved()</code> accepts the X and Y coordinates of the mouse
and the X and Y difference from the mouse's last position.<p><code>View:on_mouse_pressed()</code> accepts the button pressed, the X and Y coordinates where the button is pressed
and the number of clicks (from 1 to 3).<p><code>View:on_mouse_released()</code> accepts the same arguments as <code>View:on_mouse_pressed()</code> except the number of clicks.<p><code>View:on_mouse_wheel()</code> accepts the number of steps scrolled vertically and horizontally.<p>All of these methods except <code>View:on_mouse_released()</code> returns a boolean indicating that the event is handled.<p>In our example, we'll implement dragging the text around the view.<div class=highlight><pre><span></span><code><a id=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1>-- mod-version:3</span>
<a id=__codelineno-5-2 href=#__codelineno-5-2></a><span class=kd>local</span> <span class=n>core</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core&quot;</span>
<a id=__codelineno-5-3 href=#__codelineno-5-3></a><span class=kd>local</span> <span class=n>command</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.command&quot;</span>
<a id=__codelineno-5-4 href=#__codelineno-5-4></a><span class=kd>local</span> <span class=n>common</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.common&quot;</span>
<a id=__codelineno-5-5 href=#__codelineno-5-5></a><span class=kd>local</span> <span class=n>style</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.style&quot;</span>
<a id=__codelineno-5-6 href=#__codelineno-5-6></a>
<a id=__codelineno-5-7 href=#__codelineno-5-7></a><span class=kd>local</span> <span class=n>View</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.view&quot;</span>
<a id=__codelineno-5-8 href=#__codelineno-5-8></a>
<a id=__codelineno-5-9 href=#__codelineno-5-9></a><span class=kd>local</span> <span class=n>HelloView</span> <span class=o>=</span> <span class=n>View</span><span class=p>:</span><span class=n>extend</span><span class=p>()</span>
<a id=__codelineno-5-10 href=#__codelineno-5-10></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>new</span><span class=p>()</span>
<a id=__codelineno-5-11 href=#__codelineno-5-11></a>  <span class=c1>-- This is the constructor for HelloView.</span>
<a id=__codelineno-5-12 href=#__codelineno-5-12></a>  <span class=c1>-- Here, we&#39;ll call View&#39;s constructor to initialize</span>
<a id=__codelineno-5-13 href=#__codelineno-5-13></a>  <span class=c1>-- some important states.</span>
<a id=__codelineno-5-14 href=#__codelineno-5-14></a>  <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>new</span><span class=p>(</span><span class=n>self</span><span class=p>)</span>
<a id=__codelineno-5-15 href=#__codelineno-5-15></a>  <span class=c1>-- Set a caption that we&#39;ll use later</span>
<a id=__codelineno-5-16 href=#__codelineno-5-16></a>  <span class=n>self</span><span class=p>:</span><span class=n>set_caption</span> <span class=s2>&quot;Hello world!&quot;</span>
<a id=__codelineno-5-17 href=#__codelineno-5-17></a>  <span class=c1>-- Position of the caption relative to View</span>
<a id=__codelineno-5-18 href=#__codelineno-5-18></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span> <span class=o>=</span> <span class=p>{</span> <span class=n>x</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>}</span>
<a id=__codelineno-5-19 href=#__codelineno-5-19></a>  <span class=c1>-- Position of cursor relative to caption</span>
<a id=__codelineno-5-20 href=#__codelineno-5-20></a>  <span class=n>self</span><span class=p>.</span><span class=n>cursor_pos</span> <span class=o>=</span> <span class=p>{</span> <span class=n>x</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>}</span>
<a id=__codelineno-5-21 href=#__codelineno-5-21></a>  <span class=c1>-- True if the user is dragging the caption</span>
<a id=__codelineno-5-22 href=#__codelineno-5-22></a>  <span class=n>self</span><span class=p>.</span><span class=n>hold</span> <span class=o>=</span> <span class=kc>false</span>
<a id=__codelineno-5-23 href=#__codelineno-5-23></a>  <span class=n>self</span><span class=p>.</span><span class=n>scrollable</span> <span class=o>=</span> <span class=kc>true</span>
<a id=__codelineno-5-24 href=#__codelineno-5-24></a><span class=kr>end</span>
<a id=__codelineno-5-25 href=#__codelineno-5-25></a>
<a id=__codelineno-5-26 href=#__codelineno-5-26></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_name</span><span class=p>()</span>
<a id=__codelineno-5-27 href=#__codelineno-5-27></a>  <span class=c1>-- Returns the display name of the View.</span>
<a id=__codelineno-5-28 href=#__codelineno-5-28></a>  <span class=c1>-- If tabs are enabled, this will be displayed as the tab title.</span>
<a id=__codelineno-5-29 href=#__codelineno-5-29></a>  <span class=kr>return</span> <span class=s2>&quot;Hello!&quot;</span>
<a id=__codelineno-5-30 href=#__codelineno-5-30></a><span class=kr>end</span>
<a id=__codelineno-5-31 href=#__codelineno-5-31></a>
<a id=__codelineno-5-32 href=#__codelineno-5-32></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_caption_size</span><span class=p>()</span>
<a id=__codelineno-5-33 href=#__codelineno-5-33></a>  <span class=c1>-- getter method for caption size</span>
<a id=__codelineno-5-34 href=#__codelineno-5-34></a>  <span class=kr>return</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_w</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_h</span>
<a id=__codelineno-5-35 href=#__codelineno-5-35></a><span class=kr>end</span>
<a id=__codelineno-5-36 href=#__codelineno-5-36></a>
<a id=__codelineno-5-37 href=#__codelineno-5-37></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>set_caption</span><span class=p>(</span><span class=n>caption</span><span class=p>)</span>
<a id=__codelineno-5-38 href=#__codelineno-5-38></a>  <span class=c1>-- setter method for caption</span>
<a id=__codelineno-5-39 href=#__codelineno-5-39></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption_w</span> <span class=o>=</span> <span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>:</span><span class=n>get_width</span><span class=p>(</span><span class=n>caption</span><span class=p>)</span>
<a id=__codelineno-5-40 href=#__codelineno-5-40></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption_h</span> <span class=o>=</span> <span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>:</span><span class=n>get_height</span><span class=p>()</span>
<a id=__codelineno-5-41 href=#__codelineno-5-41></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption</span> <span class=o>=</span> <span class=n>caption</span>
<a id=__codelineno-5-42 href=#__codelineno-5-42></a><span class=kr>end</span>
<a id=__codelineno-5-43 href=#__codelineno-5-43></a>
<a id=__codelineno-5-44 href=#__codelineno-5-44></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_scrollable_size</span><span class=p>()</span>
<a id=__codelineno-5-45 href=#__codelineno-5-45></a>  <span class=c1>-- the &quot;actual&quot; height of the View</span>
<a id=__codelineno-5-46 href=#__codelineno-5-46></a>  <span class=kr>return</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-5-47 href=#__codelineno-5-47></a><span class=kr>end</span>
<a id=__codelineno-5-48 href=#__codelineno-5-48></a>
<a id=__codelineno-5-49 href=#__codelineno-5-49></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_h_scrollable_size</span><span class=p>()</span>
<a id=__codelineno-5-50 href=#__codelineno-5-50></a>  <span class=c1>-- the &quot;actual&quot; width of the View</span>
<a id=__codelineno-5-51 href=#__codelineno-5-51></a>  <span class=kr>return</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>x</span>
<a id=__codelineno-5-52 href=#__codelineno-5-52></a><span class=kr>end</span>
<a id=__codelineno-5-53 href=#__codelineno-5-53></a>
<a id=__codelineno-5-54 href=#__codelineno-5-54></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>get_caption_bounding_box</span><span class=p>()</span>
<a id=__codelineno-5-55 href=#__codelineno-5-55></a>  <span class=kd>local</span> <span class=n>x1</span><span class=p>,</span> <span class=n>y1</span> <span class=o>=</span> <span class=n>self</span><span class=p>:</span><span class=n>get_content_offset</span><span class=p>()</span>
<a id=__codelineno-5-56 href=#__codelineno-5-56></a>  <span class=n>x1</span><span class=p>,</span> <span class=n>y1</span> <span class=o>=</span> <span class=n>x1</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>y1</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-5-57 href=#__codelineno-5-57></a>  <span class=kd>local</span> <span class=n>x2</span><span class=p>,</span> <span class=n>y2</span> <span class=o>=</span> <span class=n>x1</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_w</span><span class=p>,</span> <span class=n>y1</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_h</span>
<a id=__codelineno-5-58 href=#__codelineno-5-58></a>  <span class=kr>return</span> <span class=n>x1</span><span class=p>,</span> <span class=n>y1</span><span class=p>,</span> <span class=n>x2</span><span class=p>,</span> <span class=n>y2</span>
<a id=__codelineno-5-59 href=#__codelineno-5-59></a><span class=kr>end</span>
<a id=__codelineno-5-60 href=#__codelineno-5-60></a>
<a id=__codelineno-5-61 href=#__codelineno-5-61></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>on_mouse_pressed</span><span class=p>(</span><span class=n>button</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>clicks</span><span class=p>)</span>
<a id=__codelineno-5-62 href=#__codelineno-5-62></a>  <span class=c1>-- Skip if the event is already handled</span>
<a id=__codelineno-5-63 href=#__codelineno-5-63></a>  <span class=kr>if</span> <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>on_mouse_pressed</span><span class=p>(</span><span class=n>self</span><span class=p>,</span> <span class=n>button</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>clicks</span><span class=p>)</span> <span class=kr>then</span> <span class=kr>return</span> <span class=kc>true</span> <span class=kr>end</span>
<a id=__codelineno-5-64 href=#__codelineno-5-64></a>  <span class=kd>local</span> <span class=n>x1</span><span class=p>,</span> <span class=n>y1</span><span class=p>,</span> <span class=n>x2</span><span class=p>,</span> <span class=n>y2</span> <span class=o>=</span> <span class=n>self</span><span class=p>:</span><span class=n>get_caption_bounding_box</span><span class=p>()</span>
<a id=__codelineno-5-65 href=#__codelineno-5-65></a>  <span class=kr>if</span> <span class=n>x</span> <span class=o>&gt;=</span> <span class=n>x1</span> <span class=ow>and</span> <span class=n>y</span> <span class=o>&gt;=</span> <span class=n>y1</span> <span class=ow>and</span> <span class=n>x</span> <span class=o>&lt;=</span> <span class=n>x2</span> <span class=ow>and</span> <span class=n>y</span> <span class=o>&lt;=</span> <span class=n>y2</span> <span class=kr>then</span>
<a id=__codelineno-5-66 href=#__codelineno-5-66></a>    <span class=c1>-- Store cursor position relative to caption</span>
<a id=__codelineno-5-67 href=#__codelineno-5-67></a>    <span class=n>self</span><span class=p>.</span><span class=n>cursor_pos</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>cursor_pos</span><span class=p>.</span><span class=n>y</span> <span class=o>=</span> <span class=n>x</span> <span class=o>-</span> <span class=n>x1</span><span class=p>,</span> <span class=n>y</span> <span class=o>-</span> <span class=n>y1</span>
<a id=__codelineno-5-68 href=#__codelineno-5-68></a>    <span class=n>self</span><span class=p>.</span><span class=n>hold</span> <span class=o>=</span> <span class=kc>true</span>
<a id=__codelineno-5-69 href=#__codelineno-5-69></a>    <span class=kr>return</span> <span class=kc>true</span>
<a id=__codelineno-5-70 href=#__codelineno-5-70></a>  <span class=kr>end</span>
<a id=__codelineno-5-71 href=#__codelineno-5-71></a>  <span class=kr>return</span> <span class=kc>false</span>
<a id=__codelineno-5-72 href=#__codelineno-5-72></a><span class=kr>end</span>
<a id=__codelineno-5-73 href=#__codelineno-5-73></a>
<a id=__codelineno-5-74 href=#__codelineno-5-74></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>on_mouse_moved</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>dx</span><span class=p>,</span> <span class=n>dy</span><span class=p>)</span>
<a id=__codelineno-5-75 href=#__codelineno-5-75></a>  <span class=c1>-- Skip if the event is already handled</span>
<a id=__codelineno-5-76 href=#__codelineno-5-76></a>  <span class=kr>if</span> <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>on_mouse_moved</span><span class=p>(</span><span class=n>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>dx</span><span class=p>,</span> <span class=n>dy</span><span class=p>)</span> <span class=kr>then</span> <span class=kr>return</span> <span class=kc>true</span> <span class=kr>end</span>
<a id=__codelineno-5-77 href=#__codelineno-5-77></a>  <span class=kr>if</span> <span class=n>self</span><span class=p>.</span><span class=n>hold</span> <span class=kr>then</span>
<a id=__codelineno-5-78 href=#__codelineno-5-78></a>    <span class=c1>-- Normalize cursor position to top left corner of the caption</span>
<a id=__codelineno-5-79 href=#__codelineno-5-79></a>    <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>x</span> <span class=o>-</span> <span class=n>self</span><span class=p>.</span><span class=n>cursor_pos</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>-</span> <span class=n>self</span><span class=p>.</span><span class=n>cursor_pos</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-5-80 href=#__codelineno-5-80></a>    <span class=c1>-- Get the position relative to View</span>
<a id=__codelineno-5-81 href=#__codelineno-5-81></a>    <span class=kd>local</span> <span class=n>vx</span><span class=p>,</span> <span class=n>vy</span> <span class=o>=</span> <span class=n>self</span><span class=p>:</span><span class=n>get_content_offset</span><span class=p>()</span>
<a id=__codelineno-5-82 href=#__codelineno-5-82></a>    <span class=kd>local</span> <span class=n>vw</span><span class=p>,</span> <span class=n>vh</span> <span class=o>=</span> <span class=n>self</span><span class=p>:</span><span class=n>get_h_scrollable_size</span><span class=p>()</span> <span class=o>-</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_w</span><span class=p>,</span> <span class=n>self</span><span class=p>:</span><span class=n>get_scrollable_size</span><span class=p>()</span> <span class=o>-</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_h</span>
<a id=__codelineno-5-83 href=#__codelineno-5-83></a>    <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>y</span> <span class=o>=</span> <span class=n>common</span><span class=p>.</span><span class=n>clamp</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>vx</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>vw</span><span class=p>),</span> <span class=n>common</span><span class=p>.</span><span class=n>clamp</span><span class=p>(</span><span class=n>y</span> <span class=o>-</span> <span class=n>vy</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>vh</span><span class=p>)</span>
<a id=__codelineno-5-84 href=#__codelineno-5-84></a>  <span class=kr>end</span>
<a id=__codelineno-5-85 href=#__codelineno-5-85></a><span class=kr>end</span>
<a id=__codelineno-5-86 href=#__codelineno-5-86></a>
<a id=__codelineno-5-87 href=#__codelineno-5-87></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>on_mouse_released</span><span class=p>(...)</span>
<a id=__codelineno-5-88 href=#__codelineno-5-88></a>  <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>on_mouse_released</span><span class=p>(</span><span class=n>self</span><span class=p>,</span> <span class=p>...)</span>
<a id=__codelineno-5-89 href=#__codelineno-5-89></a>  <span class=n>self</span><span class=p>.</span><span class=n>hold</span> <span class=o>=</span> <span class=kc>false</span>
<a id=__codelineno-5-90 href=#__codelineno-5-90></a><span class=kr>end</span>
<a id=__codelineno-5-91 href=#__codelineno-5-91></a>
<a id=__codelineno-5-92 href=#__codelineno-5-92></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>update</span><span class=p>()</span>
<a id=__codelineno-5-93 href=#__codelineno-5-93></a>  <span class=c1>-- Update some important View states.</span>
<a id=__codelineno-5-94 href=#__codelineno-5-94></a>  <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>update</span><span class=p>(</span><span class=n>self</span><span class=p>)</span>
<a id=__codelineno-5-95 href=#__codelineno-5-95></a>  <span class=c1>-- system.get_time() returns the number of seconds since Lite XL started.</span>
<a id=__codelineno-5-96 href=#__codelineno-5-96></a>  <span class=n>self</span><span class=p>:</span><span class=n>set_caption</span><span class=p>(</span><span class=nb>string.format</span><span class=p>(</span><span class=s2>&quot;Time elapsed: %.2f&quot;</span><span class=p>,</span> <span class=n>system</span><span class=p>.</span><span class=n>get_time</span><span class=p>()))</span>
<a id=__codelineno-5-97 href=#__codelineno-5-97></a>  <span class=c1>-- This tells Lite XL that we want to constantly redraw.</span>
<a id=__codelineno-5-98 href=#__codelineno-5-98></a>  <span class=n>core</span><span class=p>.</span><span class=n>redraw</span> <span class=o>=</span> <span class=kc>true</span>
<a id=__codelineno-5-99 href=#__codelineno-5-99></a><span class=kr>end</span>
<a id=__codelineno-5-100 href=#__codelineno-5-100></a>
<a id=__codelineno-5-101 href=#__codelineno-5-101></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>draw</span><span class=p>()</span>
<a id=__codelineno-5-102 href=#__codelineno-5-102></a>  <span class=c1>-- You should call this to avoid overdrawing</span>
<a id=__codelineno-5-103 href=#__codelineno-5-103></a>  <span class=c1>-- previous content.</span>
<a id=__codelineno-5-104 href=#__codelineno-5-104></a>  <span class=n>self</span><span class=p>:</span><span class=n>draw_background</span><span class=p>(</span><span class=n>style</span><span class=p>.</span><span class=n>background</span><span class=p>)</span>
<a id=__codelineno-5-105 href=#__codelineno-5-105></a>  <span class=c1>-- Get the top-left corner of the View</span>
<a id=__codelineno-5-106 href=#__codelineno-5-106></a>  <span class=kd>local</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>self</span><span class=p>:</span><span class=n>get_content_offset</span><span class=p>()</span>
<a id=__codelineno-5-107 href=#__codelineno-5-107></a>  <span class=c1>-- Calculate the absolute position of the caption</span>
<a id=__codelineno-5-108 href=#__codelineno-5-108></a>  <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-5-109 href=#__codelineno-5-109></a>  <span class=c1>-- We&#39;re using renderer.draw_text() as we don&#39;t need the alignment</span>
<a id=__codelineno-5-110 href=#__codelineno-5-110></a>  <span class=c1>-- goodies anymore.</span>
<a id=__codelineno-5-111 href=#__codelineno-5-111></a>  <span class=c1>-- Note the different order of arguments.</span>
<a id=__codelineno-5-112 href=#__codelineno-5-112></a>  <span class=n>renderer</span><span class=p>.</span><span class=n>draw_text</span><span class=p>(</span><span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>caption</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>style</span><span class=p>.</span><span class=n>text</span><span class=p>)</span>
<a id=__codelineno-5-113 href=#__codelineno-5-113></a>  <span class=c1>-- Draw the scrollbar</span>
<a id=__codelineno-5-114 href=#__codelineno-5-114></a>  <span class=n>self</span><span class=p>:</span><span class=n>draw_scrollbar</span><span class=p>()</span>
<a id=__codelineno-5-115 href=#__codelineno-5-115></a><span class=kr>end</span>
<a id=__codelineno-5-116 href=#__codelineno-5-116></a>
<a id=__codelineno-5-117 href=#__codelineno-5-117></a><span class=c1>-- Add a command to create a View.</span>
<a id=__codelineno-5-118 href=#__codelineno-5-118></a><span class=n>command</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=p>{</span>
<a id=__codelineno-5-119 href=#__codelineno-5-119></a>  <span class=p>[</span><span class=s2>&quot;hello:hello&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kr>function</span><span class=p>()</span>
<a id=__codelineno-5-120 href=#__codelineno-5-120></a>    <span class=c1>-- We&#39;ll get the current active node and add a view to it.</span>
<a id=__codelineno-5-121 href=#__codelineno-5-121></a>    <span class=c1>-- This will usually create a new tab.</span>
<a id=__codelineno-5-122 href=#__codelineno-5-122></a>    <span class=n>core</span><span class=p>.</span><span class=n>root_view</span><span class=p>:</span><span class=n>get_active_node</span><span class=p>():</span><span class=n>add_view</span><span class=p>(</span><span class=n>HelloView</span><span class=p>())</span>
<a id=__codelineno-5-123 href=#__codelineno-5-123></a>  <span class=kr>end</span>
<a id=__codelineno-5-124 href=#__codelineno-5-124></a><span class=p>})</span>
</code></pre></div><p>We've used <code>on_mouse_pressed()</code>, <code>on_mouse_moved()</code> and <code>on_mouse_released()</code> method to track the cursor
and draw the caption at the correct position.
Note that <code>View:get_scrollable_size()</code> and <code>View:get_h_scrollable_size()</code> is used to compute the surface size.
The text can now be dragged around.<h3 id=text-input>Text Input</h3><p>To receive text input events, you must override <code>View:supports_text_input()</code> and return <code>true</code>,
then override <code>View:on_text_input()</code> and handle events.<p>Additionally, if you wish to handle IME composition events as well,
you can override <code>View:on_ime_text_editing()</code>.
Most text editors uses this event to show a preview of the text being composed.<div class=highlight><pre><span></span><code><a id=__codelineno-6-1 href=#__codelineno-6-1></a><span class=kr>function</span> <span class=nc>View</span><span class=p>:</span><span class=nf>on_text_input</span><span class=p>(</span><span class=n>text</span><span class=p>:</span> <span class=n>string</span><span class=p>):</span> <span class=kc>nil</span> <span class=kr>end</span>
<a id=__codelineno-6-2 href=#__codelineno-6-2></a><span class=kr>function</span> <span class=nc>View</span><span class=p>:</span><span class=nf>on_ime_text_editing</span><span class=p>(</span><span class=n>text</span><span class=p>:</span> <span class=n>string</span><span class=p>,</span>
<a id=__codelineno-6-3 href=#__codelineno-6-3></a>                                  <span class=n>start</span><span class=p>:</span> <span class=n>number</span><span class=p>,</span>
<a id=__codelineno-6-4 href=#__codelineno-6-4></a>                                  <span class=n>length</span><span class=p>:</span> <span class=n>number</span><span class=p>):</span> <span class=kc>nil</span> <span class=kr>end</span>
</code></pre></div><p><code>View:on_text_input()</code> accepts a string containing the text entered and returns nothing.<p><code>View:on_ime_text_editing()</code> accepts the text being composited, the start of current composition selection
and the length of said selection.
Generally, this event is emitted until the user finalizes the composition,
then <code>on_text_input()</code> will be emitted followed by an empty <code>on_ime_text_editing</code> event.<p>For instance, for inputting the text "hello" with a Pinyin IME:<div class=highlight><pre><span></span><code><a id=__codelineno-7-1 href=#__codelineno-7-1></a>on_ime_text_editing: &quot;和&quot;, 3, 0
<a id=__codelineno-7-2 href=#__codelineno-7-2></a>on_ime_text_editing: &quot;合理&quot;, 6, 0
<a id=__codelineno-7-3 href=#__codelineno-7-3></a>on_ime_text_editing: &quot;hell&quot;, 3, 0
<a id=__codelineno-7-4 href=#__codelineno-7-4></a>on_ime_text_editing: &quot;hello&quot;, 3, 0
<a id=__codelineno-7-5 href=#__codelineno-7-5></a>on_text_input: &quot;hello&quot;
<a id=__codelineno-7-6 href=#__codelineno-7-6></a>on_ime_text_editing: &quot;&quot;, 0, 0
</code></pre></div><p>Let's implement rudimentary text input in our example.<p>In our example, we'll add support for text input and IME composition.<div class=highlight><pre><span></span><code><a id=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1>--mod-version:3</span>
<a id=__codelineno-8-2 href=#__codelineno-8-2></a><span class=kd>local</span> <span class=n>core</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core&quot;</span>
<a id=__codelineno-8-3 href=#__codelineno-8-3></a><span class=kd>local</span> <span class=n>command</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.command&quot;</span>
<a id=__codelineno-8-4 href=#__codelineno-8-4></a><span class=kd>local</span> <span class=n>common</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.common&quot;</span>
<a id=__codelineno-8-5 href=#__codelineno-8-5></a><span class=kd>local</span> <span class=n>ime</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.ime&quot;</span>
<a id=__codelineno-8-6 href=#__codelineno-8-6></a><span class=kd>local</span> <span class=n>keymap</span> <span class=o>=</span><span class=nb>require</span> <span class=s2>&quot;core.keymap&quot;</span>
<a id=__codelineno-8-7 href=#__codelineno-8-7></a><span class=kd>local</span> <span class=n>style</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.style&quot;</span>
<a id=__codelineno-8-8 href=#__codelineno-8-8></a>
<a id=__codelineno-8-9 href=#__codelineno-8-9></a><span class=kd>local</span> <span class=n>View</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core.view&quot;</span>
<a id=__codelineno-8-10 href=#__codelineno-8-10></a>
<a id=__codelineno-8-11 href=#__codelineno-8-11></a><span class=kd>local</span> <span class=n>HelloView</span> <span class=o>=</span> <span class=n>View</span><span class=p>:</span><span class=n>extend</span><span class=p>()</span>
<a id=__codelineno-8-12 href=#__codelineno-8-12></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>new</span><span class=p>()</span>
<a id=__codelineno-8-13 href=#__codelineno-8-13></a>  <span class=c1>-- This is HelloView&#39;s constructor.</span>
<a id=__codelineno-8-14 href=#__codelineno-8-14></a>  <span class=c1>-- You must call the super constructor to initialize important state data.</span>
<a id=__codelineno-8-15 href=#__codelineno-8-15></a>  <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>new</span><span class=p>(</span><span class=n>self</span><span class=p>)</span>
<a id=__codelineno-8-16 href=#__codelineno-8-16></a>  <span class=c1>-- The position of the caption relative to the view</span>
<a id=__codelineno-8-17 href=#__codelineno-8-17></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span> <span class=o>=</span> <span class=p>{</span> <span class=n>x</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>}</span>
<a id=__codelineno-8-18 href=#__codelineno-8-18></a>  <span class=c1>-- The offset of the cursor from the top left corner of the caption</span>
<a id=__codelineno-8-19 href=#__codelineno-8-19></a>  <span class=c1>-- when it is held</span>
<a id=__codelineno-8-20 href=#__codelineno-8-20></a>  <span class=n>self</span><span class=p>.</span><span class=n>cursor_offset</span> <span class=o>=</span> <span class=p>{</span> <span class=n>x</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>}</span>
<a id=__codelineno-8-21 href=#__codelineno-8-21></a>  <span class=c1>-- The caption and its pixel width</span>
<a id=__codelineno-8-22 href=#__codelineno-8-22></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
<a id=__codelineno-8-23 href=#__codelineno-8-23></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption_w</span> <span class=o>=</span> <span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>:</span><span class=n>get_width</span><span class=p>(</span><span class=n>self</span><span class=p>.</span><span class=n>caption</span><span class=p>)</span>
<a id=__codelineno-8-24 href=#__codelineno-8-24></a>  <span class=c1>-- IME text composition state</span>
<a id=__codelineno-8-25 href=#__codelineno-8-25></a>  <span class=n>self</span><span class=p>.</span><span class=n>composition</span> <span class=o>=</span> <span class=p>{</span> <span class=n>text</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=n>start</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>length</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>}</span>
<a id=__codelineno-8-26 href=#__codelineno-8-26></a>  <span class=n>self</span><span class=p>.</span><span class=n>hold</span> <span class=o>=</span> <span class=kc>false</span>
<a id=__codelineno-8-27 href=#__codelineno-8-27></a><span class=kr>end</span>
<a id=__codelineno-8-28 href=#__codelineno-8-28></a>
<a id=__codelineno-8-29 href=#__codelineno-8-29></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>on_mouse_moved</span><span class=p>(</span><span class=n>px</span><span class=p>,</span> <span class=n>py</span><span class=p>,</span> <span class=n>dx</span><span class=p>,</span> <span class=n>dy</span><span class=p>)</span>
<a id=__codelineno-8-30 href=#__codelineno-8-30></a>  <span class=c1>-- If the super method already handled the event, we shouldn&#39;t handle it.</span>
<a id=__codelineno-8-31 href=#__codelineno-8-31></a>  <span class=c1>-- This is important for scrollbar handling if view is scrollable.</span>
<a id=__codelineno-8-32 href=#__codelineno-8-32></a>  <span class=kr>if</span> <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>on_mouse_moved</span><span class=p>(</span><span class=n>self</span><span class=p>,</span> <span class=n>px</span><span class=p>,</span> <span class=n>py</span><span class=p>,</span> <span class=n>dx</span><span class=p>,</span> <span class=n>dy</span><span class=p>)</span> <span class=kr>then</span> <span class=kr>return</span> <span class=kc>true</span> <span class=kr>end</span>
<a id=__codelineno-8-33 href=#__codelineno-8-33></a>  <span class=c1>-- If we&#39;re not holding down mouse we should ignore the event</span>
<a id=__codelineno-8-34 href=#__codelineno-8-34></a>  <span class=kr>if</span> <span class=ow>not</span> <span class=n>self</span><span class=p>.</span><span class=n>hold</span> <span class=kr>then</span> <span class=kr>return</span> <span class=kr>end</span>
<a id=__codelineno-8-35 href=#__codelineno-8-35></a>
<a id=__codelineno-8-36 href=#__codelineno-8-36></a>  <span class=c1>-- Correct the mouse position to behave as if the cursor was placed on the</span>
<a id=__codelineno-8-37 href=#__codelineno-8-37></a>  <span class=c1>-- top-left corner of the caption.</span>
<a id=__codelineno-8-38 href=#__codelineno-8-38></a>  <span class=c1>-- Without this, the caption will &quot;jump&quot; towards the cursor.</span>
<a id=__codelineno-8-39 href=#__codelineno-8-39></a>  <span class=n>px</span><span class=p>,</span> <span class=n>py</span> <span class=o>=</span> <span class=n>px</span> <span class=o>-</span> <span class=n>self</span><span class=p>.</span><span class=n>cursor_offset</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>py</span> <span class=o>-</span> <span class=n>self</span><span class=p>.</span><span class=n>cursor_offset</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-8-40 href=#__codelineno-8-40></a>
<a id=__codelineno-8-41 href=#__codelineno-8-41></a>  <span class=c1>-- Calculate the bounding rectangle of the Viee</span>
<a id=__codelineno-8-42 href=#__codelineno-8-42></a>  <span class=kd>local</span> <span class=n>x1</span><span class=p>,</span> <span class=n>y1</span> <span class=o>=</span> <span class=n>self</span><span class=p>:</span><span class=n>get_content_offset</span><span class=p>()</span>
<a id=__codelineno-8-43 href=#__codelineno-8-43></a>  <span class=c1>-- Here, the bounding rectangle is shrunk by the size of the caption.</span>
<a id=__codelineno-8-44 href=#__codelineno-8-44></a>  <span class=c1>-- This prevents the caption from clipping out of the view.</span>
<a id=__codelineno-8-45 href=#__codelineno-8-45></a>  <span class=kd>local</span> <span class=n>x2</span><span class=p>,</span> <span class=n>y2</span> <span class=o>=</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>x</span> <span class=o>-</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_w</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>y</span> <span class=o>-</span> <span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>:</span><span class=n>get_height</span><span class=p>()</span>
<a id=__codelineno-8-46 href=#__codelineno-8-46></a>
<a id=__codelineno-8-47 href=#__codelineno-8-47></a>  <span class=c1>-- Set the position of the caption relative to the view.</span>
<a id=__codelineno-8-48 href=#__codelineno-8-48></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>y</span> <span class=o>=</span> <span class=n>common</span><span class=p>.</span><span class=n>clamp</span><span class=p>(</span><span class=n>px</span> <span class=o>-</span> <span class=n>x1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>x2</span><span class=p>),</span> <span class=n>common</span><span class=p>.</span><span class=n>clamp</span><span class=p>(</span><span class=n>py</span> <span class=o>-</span> <span class=n>y1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>y2</span><span class=p>)</span>
<a id=__codelineno-8-49 href=#__codelineno-8-49></a>  <span class=kr>return</span> <span class=kc>true</span>
<a id=__codelineno-8-50 href=#__codelineno-8-50></a><span class=kr>end</span>
<a id=__codelineno-8-51 href=#__codelineno-8-51></a>
<a id=__codelineno-8-52 href=#__codelineno-8-52></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>on_mouse_pressed</span><span class=p>(</span><span class=n>button</span><span class=p>,</span> <span class=n>px</span><span class=p>,</span> <span class=n>py</span><span class=p>,</span> <span class=n>clicks</span><span class=p>)</span>
<a id=__codelineno-8-53 href=#__codelineno-8-53></a>  <span class=c1>-- If the super method handled the event we should skip our own handler.</span>
<a id=__codelineno-8-54 href=#__codelineno-8-54></a>  <span class=kr>if</span> <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>on_mouse_pressed</span><span class=p>(</span><span class=n>self</span><span class=p>,</span> <span class=n>button</span><span class=p>,</span> <span class=n>px</span><span class=p>,</span> <span class=n>py</span><span class=p>,</span> <span class=n>clicks</span><span class=p>)</span> <span class=kr>then</span> <span class=kr>return</span> <span class=kc>true</span> <span class=kr>end</span>
<a id=__codelineno-8-55 href=#__codelineno-8-55></a>
<a id=__codelineno-8-56 href=#__codelineno-8-56></a>  <span class=c1>-- the bounding box of the caption</span>
<a id=__codelineno-8-57 href=#__codelineno-8-57></a>  <span class=kd>local</span> <span class=n>x1</span><span class=p>,</span> <span class=n>y1</span> <span class=o>=</span> <span class=n>self</span><span class=p>:</span><span class=n>get_content_offset</span><span class=p>()</span>
<a id=__codelineno-8-58 href=#__codelineno-8-58></a>  <span class=n>x1</span><span class=p>,</span> <span class=n>y1</span> <span class=o>=</span> <span class=n>x1</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>y1</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-8-59 href=#__codelineno-8-59></a>  <span class=kd>local</span> <span class=n>x2</span><span class=p>,</span> <span class=n>y2</span> <span class=o>=</span> <span class=n>x1</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_w</span><span class=p>,</span> <span class=n>y1</span> <span class=o>+</span> <span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>:</span><span class=n>get_height</span><span class=p>()</span>
<a id=__codelineno-8-60 href=#__codelineno-8-60></a>
<a id=__codelineno-8-61 href=#__codelineno-8-61></a>  <span class=kr>if</span> <span class=n>px</span> <span class=o>&gt;=</span> <span class=n>x1</span> <span class=ow>and</span> <span class=n>py</span> <span class=o>&gt;=</span> <span class=n>y1</span> <span class=ow>and</span> <span class=n>px</span> <span class=o>&lt;=</span> <span class=n>x2</span> <span class=ow>and</span> <span class=n>py</span> <span class=o>&lt;=</span> <span class=n>y2</span> <span class=kr>then</span>
<a id=__codelineno-8-62 href=#__codelineno-8-62></a>    <span class=c1>-- Save the cursor position relative to the caption</span>
<a id=__codelineno-8-63 href=#__codelineno-8-63></a>    <span class=n>self</span><span class=p>.</span><span class=n>cursor_offset</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>cursor_offset</span><span class=p>.</span><span class=n>y</span> <span class=o>=</span> <span class=n>px</span> <span class=o>-</span> <span class=n>x1</span><span class=p>,</span> <span class=n>py</span> <span class=o>-</span> <span class=n>y1</span>
<a id=__codelineno-8-64 href=#__codelineno-8-64></a>    <span class=n>self</span><span class=p>.</span><span class=n>hold</span> <span class=o>=</span> <span class=kc>true</span>
<a id=__codelineno-8-65 href=#__codelineno-8-65></a>  <span class=kr>end</span>
<a id=__codelineno-8-66 href=#__codelineno-8-66></a>  <span class=kr>return</span> <span class=kc>true</span>
<a id=__codelineno-8-67 href=#__codelineno-8-67></a><span class=kr>end</span>
<a id=__codelineno-8-68 href=#__codelineno-8-68></a>
<a id=__codelineno-8-69 href=#__codelineno-8-69></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>on_mouse_released</span><span class=p>(...)</span>
<a id=__codelineno-8-70 href=#__codelineno-8-70></a>  <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>on_mouse_released</span><span class=p>(</span><span class=n>self</span><span class=p>,</span> <span class=p>...)</span>
<a id=__codelineno-8-71 href=#__codelineno-8-71></a>  <span class=n>self</span><span class=p>.</span><span class=n>hold</span> <span class=o>=</span> <span class=kc>false</span>
<a id=__codelineno-8-72 href=#__codelineno-8-72></a><span class=kr>end</span>
<a id=__codelineno-8-73 href=#__codelineno-8-73></a>
<a id=__codelineno-8-74 href=#__codelineno-8-74></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>supports_text_input</span><span class=p>()</span>
<a id=__codelineno-8-75 href=#__codelineno-8-75></a>  <span class=c1>-- tell Lite XL that we support text input</span>
<a id=__codelineno-8-76 href=#__codelineno-8-76></a>  <span class=kr>return</span> <span class=kc>true</span>
<a id=__codelineno-8-77 href=#__codelineno-8-77></a><span class=kr>end</span>
<a id=__codelineno-8-78 href=#__codelineno-8-78></a>
<a id=__codelineno-8-79 href=#__codelineno-8-79></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>on_text_input</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
<a id=__codelineno-8-80 href=#__codelineno-8-80></a>  <span class=c1>-- Append text to the caption and recalculate the width</span>
<a id=__codelineno-8-81 href=#__codelineno-8-81></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption</span> <span class=o>=</span> <span class=n>self</span><span class=p>.</span><span class=n>caption</span> <span class=o>..</span> <span class=n>text</span>
<a id=__codelineno-8-82 href=#__codelineno-8-82></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption_w</span> <span class=o>=</span> <span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>:</span><span class=n>get_width</span><span class=p>(</span><span class=n>self</span><span class=p>.</span><span class=n>caption</span><span class=p>)</span>
<a id=__codelineno-8-83 href=#__codelineno-8-83></a><span class=kr>end</span>
<a id=__codelineno-8-84 href=#__codelineno-8-84></a>
<a id=__codelineno-8-85 href=#__codelineno-8-85></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>on_ime_text_editing</span><span class=p>(</span><span class=n>text</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>length</span><span class=p>)</span>
<a id=__codelineno-8-86 href=#__codelineno-8-86></a>  <span class=c1>-- Store composition state</span>
<a id=__codelineno-8-87 href=#__codelineno-8-87></a>  <span class=n>self</span><span class=p>.</span><span class=n>composition</span> <span class=o>=</span> <span class=p>{</span> <span class=n>text</span> <span class=o>=</span> <span class=n>text</span><span class=p>,</span> <span class=n>start</span> <span class=o>=</span> <span class=n>start</span><span class=p>,</span> <span class=n>length</span> <span class=o>=</span> <span class=n>length</span> <span class=p>}</span>
<a id=__codelineno-8-88 href=#__codelineno-8-88></a><span class=kr>end</span>
<a id=__codelineno-8-89 href=#__codelineno-8-89></a>
<a id=__codelineno-8-90 href=#__codelineno-8-90></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>update</span><span class=p>()</span>
<a id=__codelineno-8-91 href=#__codelineno-8-91></a>  <span class=c1>-- You should do state management in this method.</span>
<a id=__codelineno-8-92 href=#__codelineno-8-92></a>  <span class=c1>-- If you override this method, you must call the super method.</span>
<a id=__codelineno-8-93 href=#__codelineno-8-93></a>  <span class=n>HelloView</span><span class=p>.</span><span class=n>super</span><span class=p>.</span><span class=n>update</span><span class=p>(</span><span class=n>self</span><span class=p>)</span>
<a id=__codelineno-8-94 href=#__codelineno-8-94></a>
<a id=__codelineno-8-95 href=#__codelineno-8-95></a>  <span class=kr>if</span> <span class=n>self</span><span class=p>.</span><span class=n>composition</span><span class=p>.</span><span class=n>text</span> <span class=o>~=</span> <span class=s2>&quot;&quot;</span> <span class=kr>then</span>
<a id=__codelineno-8-96 href=#__codelineno-8-96></a>    <span class=c1>-- We need to tell the system where to put the IME window.</span>
<a id=__codelineno-8-97 href=#__codelineno-8-97></a>    <span class=c1>-- Get the bounding box of the selected composition text</span>
<a id=__codelineno-8-98 href=#__codelineno-8-98></a>    <span class=kd>local</span> <span class=n>ime_selection_text</span> <span class=o>=</span> <span class=n>self</span><span class=p>.</span><span class=n>composition</span><span class=p>.</span><span class=n>text</span><span class=p>:</span><span class=n>usub</span><span class=p>(</span><span class=n>self</span><span class=p>.</span><span class=n>composition</span><span class=p>.</span><span class=n>start</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>composition</span><span class=p>.</span><span class=n>length</span><span class=p>)</span>
<a id=__codelineno-8-99 href=#__codelineno-8-99></a>    <span class=kd>local</span> <span class=n>ime_not_selected</span> <span class=o>=</span> <span class=n>self</span><span class=p>.</span><span class=n>composition</span><span class=p>.</span><span class=n>text</span><span class=p>:</span><span class=n>usub</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>composition</span><span class=p>.</span><span class=n>start</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-8-100 href=#__codelineno-8-100></a>    <span class=kd>local</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>self</span><span class=p>:</span><span class=n>get_content_offset</span><span class=p>()</span>
<a id=__codelineno-8-101 href=#__codelineno-8-101></a>    <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>x</span> <span class=o>+</span> <span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>:</span><span class=n>get_width</span><span class=p>(</span><span class=n>ime_not_selected</span><span class=p>),</span> <span class=n>y</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-8-102 href=#__codelineno-8-102></a>    <span class=c1>-- Set the position of the IME window</span>
<a id=__codelineno-8-103 href=#__codelineno-8-103></a>    <span class=n>ime</span><span class=p>.</span><span class=n>set_location</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>:</span><span class=n>get_width</span><span class=p>(</span><span class=n>ime_selection_text</span><span class=p>),</span> <span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>:</span><span class=n>get_height</span><span class=p>())</span>
<a id=__codelineno-8-104 href=#__codelineno-8-104></a>  <span class=kr>end</span>
<a id=__codelineno-8-105 href=#__codelineno-8-105></a><span class=kr>end</span>
<a id=__codelineno-8-106 href=#__codelineno-8-106></a>
<a id=__codelineno-8-107 href=#__codelineno-8-107></a><span class=kr>function</span> <span class=nc>HelloView</span><span class=p>:</span><span class=nf>draw</span><span class=p>()</span>
<a id=__codelineno-8-108 href=#__codelineno-8-108></a>  <span class=c1>-- In here, we did not call self.super.draw(self) because we&#39;re extending View.</span>
<a id=__codelineno-8-109 href=#__codelineno-8-109></a>  <span class=c1>-- View&#39;s draw() method does nothing.</span>
<a id=__codelineno-8-110 href=#__codelineno-8-110></a>  <span class=c1>-- Instead, we&#39;ll call self:draw_background() to draw the background.</span>
<a id=__codelineno-8-111 href=#__codelineno-8-111></a>  <span class=c1>-- If you don&#39;t call this, you&#39;ll overdraw previous content.</span>
<a id=__codelineno-8-112 href=#__codelineno-8-112></a>  <span class=n>self</span><span class=p>:</span><span class=n>draw_background</span><span class=p>(</span><span class=n>style</span><span class=p>.</span><span class=n>background</span><span class=p>)</span>
<a id=__codelineno-8-113 href=#__codelineno-8-113></a>  <span class=c1>-- get the x and y offset of the View.</span>
<a id=__codelineno-8-114 href=#__codelineno-8-114></a>  <span class=c1>-- Since a view can be anywhere within a window, you must use this x and y</span>
<a id=__codelineno-8-115 href=#__codelineno-8-115></a>  <span class=c1>-- offset to ensure that you&#39;re drawing inside your View.</span>
<a id=__codelineno-8-116 href=#__codelineno-8-116></a>  <span class=c1>-- Otherwise, you will draw on other Views and the content can get obscured.</span>
<a id=__codelineno-8-117 href=#__codelineno-8-117></a>  <span class=kd>local</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>self</span><span class=p>:</span><span class=n>get_content_offset</span><span class=p>()</span>
<a id=__codelineno-8-118 href=#__codelineno-8-118></a>  <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=n>self</span><span class=p>.</span><span class=n>caption_pos</span><span class=p>.</span><span class=n>y</span>
<a id=__codelineno-8-119 href=#__codelineno-8-119></a>  <span class=c1>-- Here, we switch to renderer.draw_text() because we don&#39;t need to align</span>
<a id=__codelineno-8-120 href=#__codelineno-8-120></a>  <span class=c1>-- the text anymore.</span>
<a id=__codelineno-8-121 href=#__codelineno-8-121></a>  <span class=c1>-- Note the different order of arguments.</span>
<a id=__codelineno-8-122 href=#__codelineno-8-122></a>  <span class=n>x</span> <span class=o>=</span> <span class=n>renderer</span><span class=p>.</span><span class=n>draw_text</span><span class=p>(</span><span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>,</span>
<a id=__codelineno-8-123 href=#__codelineno-8-123></a>  <span class=n>self</span><span class=p>.</span><span class=n>caption</span><span class=p>,</span>
<a id=__codelineno-8-124 href=#__codelineno-8-124></a>  <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-8-125 href=#__codelineno-8-125></a>  <span class=n>style</span><span class=p>.</span><span class=n>text</span><span class=p>)</span>
<a id=__codelineno-8-126 href=#__codelineno-8-126></a>
<a id=__codelineno-8-127 href=#__codelineno-8-127></a>  <span class=kd>local</span> <span class=n>caret_pos</span> <span class=o>=</span> <span class=n>x</span>
<a id=__codelineno-8-128 href=#__codelineno-8-128></a>  <span class=kr>if</span> <span class=n>self</span><span class=p>.</span><span class=n>composition</span><span class=p>.</span><span class=n>text</span> <span class=o>~=</span> <span class=s2>&quot;&quot;</span> <span class=kr>then</span>
<a id=__codelineno-8-129 href=#__codelineno-8-129></a>    <span class=c1>-- Draw the composition text</span>
<a id=__codelineno-8-130 href=#__codelineno-8-130></a>    <span class=kd>local</span> <span class=n>xadvance</span> <span class=o>=</span> <span class=n>renderer</span><span class=p>.</span><span class=n>draw_text</span><span class=p>(</span><span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>,</span>
<a id=__codelineno-8-131 href=#__codelineno-8-131></a>                                        <span class=n>self</span><span class=p>.</span><span class=n>composition</span><span class=p>.</span><span class=n>text</span><span class=p>,</span>
<a id=__codelineno-8-132 href=#__codelineno-8-132></a>                                        <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-8-133 href=#__codelineno-8-133></a>                                        <span class=n>style</span><span class=p>.</span><span class=n>text</span><span class=p>)</span>
<a id=__codelineno-8-134 href=#__codelineno-8-134></a>    <span class=c1>-- Draw an underline to indicate that this is a composition and not actual text.</span>
<a id=__codelineno-8-135 href=#__codelineno-8-135></a>    <span class=n>renderer</span><span class=p>.</span><span class=n>draw_rect</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>:</span><span class=n>get_height</span><span class=p>()</span> <span class=o>-</span> <span class=mi>2</span><span class=p>,</span> <span class=n>xadvance</span> <span class=o>-</span> <span class=n>x</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>style</span><span class=p>.</span><span class=n>accent</span><span class=p>)</span>
<a id=__codelineno-8-136 href=#__codelineno-8-136></a>    <span class=c1>-- The caret may appear in the middle of the composition.</span>
<a id=__codelineno-8-137 href=#__codelineno-8-137></a>    <span class=c1>-- The start parameter is the offset of the text where the selection starts, so we&#39;ll</span>
<a id=__codelineno-8-138 href=#__codelineno-8-138></a>    <span class=c1>-- use it to place the caret.</span>
<a id=__codelineno-8-139 href=#__codelineno-8-139></a>    <span class=n>x</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>:</span><span class=n>get_width</span><span class=p>(</span><span class=n>self</span><span class=p>.</span><span class=n>composition</span><span class=p>.</span><span class=n>text</span><span class=p>:</span><span class=n>usub</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>self</span><span class=p>.</span><span class=n>composition</span><span class=p>.</span><span class=n>start</span><span class=p>))</span>
<a id=__codelineno-8-140 href=#__codelineno-8-140></a>  <span class=kr>end</span>
<a id=__codelineno-8-141 href=#__codelineno-8-141></a>  <span class=c1>-- draw the caret.</span>
<a id=__codelineno-8-142 href=#__codelineno-8-142></a>  <span class=n>renderer</span><span class=p>.</span><span class=n>draw_rect</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>style</span><span class=p>.</span><span class=n>font</span><span class=p>:</span><span class=n>get_height</span><span class=p>(),</span> <span class=n>style</span><span class=p>.</span><span class=n>caret</span><span class=p>)</span>
<a id=__codelineno-8-143 href=#__codelineno-8-143></a><span class=kr>end</span>
<a id=__codelineno-8-144 href=#__codelineno-8-144></a>
<a id=__codelineno-8-145 href=#__codelineno-8-145></a>
<a id=__codelineno-8-146 href=#__codelineno-8-146></a><span class=c1>-- add a command to create a View.</span>
<a id=__codelineno-8-147 href=#__codelineno-8-147></a><span class=n>command</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=p>{</span>
<a id=__codelineno-8-148 href=#__codelineno-8-148></a>  <span class=p>[</span><span class=s2>&quot;hello:hello&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kr>function</span><span class=p>()</span>
<a id=__codelineno-8-149 href=#__codelineno-8-149></a>    <span class=c1>-- we&#39;ll get the current active node and add a view to it.</span>
<a id=__codelineno-8-150 href=#__codelineno-8-150></a>    <span class=c1>-- it will create a new tab.</span>
<a id=__codelineno-8-151 href=#__codelineno-8-151></a>    <span class=n>core</span><span class=p>.</span><span class=n>root_view</span><span class=p>:</span><span class=n>get_active_node</span><span class=p>():</span><span class=n>add_view</span><span class=p>(</span><span class=n>HelloView</span><span class=p>())</span>
<a id=__codelineno-8-152 href=#__codelineno-8-152></a>  <span class=kr>end</span><span class=p>,</span>
<a id=__codelineno-8-153 href=#__codelineno-8-153></a><span class=p>})</span>
<a id=__codelineno-8-154 href=#__codelineno-8-154></a>
<a id=__codelineno-8-155 href=#__codelineno-8-155></a><span class=c1>-- add a command to delete caption text from the back</span>
<a id=__codelineno-8-156 href=#__codelineno-8-156></a><span class=n>command</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>HelloView</span><span class=p>,</span> <span class=p>{</span>
<a id=__codelineno-8-157 href=#__codelineno-8-157></a>  <span class=p>[</span><span class=s2>&quot;hello:delete-char&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kr>function</span><span class=p>()</span>
<a id=__codelineno-8-158 href=#__codelineno-8-158></a>    <span class=c1>-- we use string.usub to account for unicode multi-byte characters</span>
<a id=__codelineno-8-159 href=#__codelineno-8-159></a>    <span class=n>core</span><span class=p>.</span><span class=n>active_view</span><span class=p>.</span><span class=n>caption</span> <span class=o>=</span> <span class=n>core</span><span class=p>.</span><span class=n>active_view</span><span class=p>.</span><span class=n>caption</span><span class=p>:</span><span class=n>usub</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-8-160 href=#__codelineno-8-160></a>  <span class=kr>end</span>
<a id=__codelineno-8-161 href=#__codelineno-8-161></a><span class=p>})</span>
<a id=__codelineno-8-162 href=#__codelineno-8-162></a>
<a id=__codelineno-8-163 href=#__codelineno-8-163></a><span class=c1>-- bind the delete command to backspace</span>
<a id=__codelineno-8-164 href=#__codelineno-8-164></a><span class=n>keymap</span><span class=p>.</span><span class=n>add</span> <span class=p>{</span>
<a id=__codelineno-8-165 href=#__codelineno-8-165></a>  <span class=p>[</span><span class=s2>&quot;backspace&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;hello:delete-char&quot;</span>
<a id=__codelineno-8-166 href=#__codelineno-8-166></a><span class=p>}</span>
</code></pre></div><p>There's a lot more to text editing than simply appending and removing text.
This is just a simple example to acquaint you with how Lite XL handle events.<h2 id=layout>Layout</h2><p>Lite XL manages UI layout in a binary tree.
Each View is stored in a Node, and the Node is stored in a binary tree with RootView as the root node.
RootView manages input and rendering events for all the Views.<p>A Node is the basic unit for a layout.
A Node has several types — <code>hsplit</code>, <code>vsplit</code> and <code>leaf</code>.
This corresponds to the <code>root:split-{up,down,left,right}</code> commands.
A <code>hsplit</code> and <code>vsplit</code> Node has two children while a <code>leaf</code> node does not.<p>To get the Node for a View, you can call <code>Node:get_node_for_view()</code>.
This function recursively searches for the view to find its parent node.
You can call <code>RootView:get_node_for_view()</code> to search the entire layout.<p>After you got the Node containing the View, you can also call <code>Node:get_view_idx()</code>.
This function will return the index of the View in the Node if the Node contains multiple Views.<h3 id=adding-views-to-the-layout>Adding Views to the layout</h3><p>To split a Node, you can call <code>Node:split(direction, view, locked, resizable)</code>.
This function takes 2 to 4 arguments, and returns the new Node containing the View passed into the function.<p><code>dir</code> specifies the split direction — <code>up</code>, <code>down</code>, <code>left</code> and <code>right</code>, and <code>view</code> is the View
to add to the new Node.<p><code>locked</code> is a table in the form <code class=highlight><span class=p>{</span> <span class=n>x</span> <span class=o>=</span> <span class=kc>true</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=kc>true</span> <span class=p>}</span></code>.
<code>x</code> and <code>y</code> corresponds to the axis of the new Node to "lock".
A locked axis has a fixed size and cannot be resized by the user.<p><code>resizable</code> is also a table with the same format as <code>locked</code>,
and corresponds to axes that will be resizable by the user.
This table overrides the options in <code>locked</code>.<p>Following the example above, if we want to add a command to open our View on the bottom, we can do:<div class=highlight><pre><span></span><code><a id=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>command</span><span class=p>.</span><span class=n>add</span> <span class=p>{</span>
<a id=__codelineno-9-2 href=#__codelineno-9-2></a>  <span class=p>[</span><span class=s2>&quot;hello:split-down&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kr>function</span><span class=p>()</span>
<a id=__codelineno-9-3 href=#__codelineno-9-3></a>    <span class=c1>-- the new Node will have a fixed initial size based on</span>
<a id=__codelineno-9-4 href=#__codelineno-9-4></a>    <span class=c1>-- what the View provides, but the user can resize it.</span>
<a id=__codelineno-9-5 href=#__codelineno-9-5></a>    <span class=c1>-- The other (old) Node will take up the rest of the space.</span>
<a id=__codelineno-9-6 href=#__codelineno-9-6></a>    <span class=n>core</span><span class=p>.</span><span class=n>root_view</span><span class=p>:</span><span class=n>get_active_node</span><span class=p>():</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;down&quot;</span><span class=p>,</span> <span class=n>view</span><span class=p>,</span> <span class=p>{</span> <span class=n>y</span> <span class=o>=</span> <span class=kc>true</span> <span class=p>},</span> <span class=p>{</span> <span class=n>y</span> <span class=o>=</span> <span class=kc>true</span> <span class=p>})</span>
<a id=__codelineno-9-7 href=#__codelineno-9-7></a>  <span class=kr>end</span>
<a id=__codelineno-9-8 href=#__codelineno-9-8></a><span class=p>}</span>
</code></pre></div><p>Other than splitting the current node, you can also add the View to an existing Node.
To do this, use <code>Node:add_view()</code>.
This function accepts a View and optionally an index to insert the View to.<h3 id=remove-views>Remove Views</h3><p>To remove a View, you can use <code>Node:remove_view()</code>. This function accepts the RootView and the View to remove.
Alternatively, you can use <code>Node:close_view()</code> to close the View as well.
This function accepts the same arguments as <code>Node:remove_view()</code>.<h2 id=overlays>Overlays</h2><p>Sometimes, drawing outside the View is needed, for instance to render overlays and popups.<p>Lite XL supports this by deferring draw calls after the entirety of RootView has been rendered.
To do this, use <code>RootView:defer_draw()</code>.<p>This function takes a callback that can use various <code>renderer</code> draw calls.
The callback will be called after RootView (all Views) are rendered.<div class="admonition tip"><p class=admonition-title>The callback will be discarded after use.<p><code>core.defer_draw()</code> is usually called in the View's render method.</div><aside class=md-source-file><span class=md-source-file__fact><span class=md-icon title="Last update"><svg viewBox="0 0 24 24"><path d="M21 13.1c-.1.0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6.0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3.0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4.0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
</span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">March 5, 2024</span></span></aside></article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div><button type=button class="md-top md-icon" data-md-component=top hidden>
<svg viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
Back to top</button></main><footer class=md-footer><nav class="md-footer__inner md-grid" aria-label=Footer><a href=../documents/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Documents"><div class="md-footer__button md-icon"><svg viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg></div><div class=md-footer__title><span class=md-footer__direction>Previous</span><div class=md-ellipsis>Documents</div></div></a><a href=../background-tasks/ class="md-footer__link md-footer__link--next" aria-label="Next: Background Tasks"><div class=md-footer__title><span class=md-footer__direction>Next</span><div class=md-ellipsis>Background Tasks</div></div><div class="md-footer__button md-icon"><svg viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright>Made with
<a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener>Material for MkDocs</a></div><div class=md-social><a href=https://github.com/lite-xl/lite-xl target=_blank rel=noopener title=github.com class=md-social__link><svg viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6.0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
</a><a href=https://discord.gg/RWzqC3nx7K target=_blank rel=noopener title=discord.gg class=md-social__link><svg viewBox="0 0 640 512"><path d="M524.531 69.836a1.5 1.5.0 00-.764-.7A485 485 0 00404.081 32.03a1.82 1.82.0 00-1.923.91 338 338 0 00-14.9 30.6 447.9 447.9.0 00-134.426.0 310 310 0 00-15.135-30.6 1.89 1.89.0 00-1.924-.91A483.7 483.7.0 00116.085 69.137a1.7 1.7.0 00-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02.0 00.765 1.375 487.7 487.7.0 00146.825 74.189 1.9 1.9.0 002.063-.676A348 348 0 00208.12 430.4a1.86 1.86.0 00-1.019-2.588 321 321 0 01-45.868-21.853 1.885 1.885.0 01-.185-3.126 251 251 0 009.109-7.137 1.82 1.82.0 011.9-.256c96.229 43.917 200.41 43.917 295.5.0a1.81 1.81.0 011.924.233 235 235 0 009.132 7.16 1.884 1.884.0 01-.162 3.126 301.4 301.4.0 01-45.89 21.83 1.875 1.875.0 00-1 2.611 391 391 0 0030.014 48.815 1.86 1.86.0 002.063.7A486 486 0 00610.7 405.729a1.88 1.88.0 00.765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972.0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665.0 53.306 26.82 52.843 59.239.0 32.654-23.41 59.241-52.843 59.241m195.38.0c-28.971.0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667.0 53.307 26.82 52.844 59.239.0 32.654-23.177 59.241-52.844 59.241"/></svg>
</a><a href=https://matrix.to/#/#lite-xl:matrix.org target=_blank rel=noopener title=matrix.to class=md-social__link><svg viewBox="0 0 24 24"><path d="M.632.55v22.9H2.28V24H0V0h2.28v.55zm7.043 7.26v1.157h.033a3.3 3.3.0 011.117-1.024c.433-.245.936-.365 1.5-.365q.81.002 1.481.314c.448.208.785.582 1.02 1.108q.382-.562 1.034-.992.651-.43 1.546-.43.679.0 1.26.167c.388.11.716.286.993.53.276.245.489.559.646.951q.229.587.23 1.417v5.728h-2.349V11.52q0-.43-.032-.812a1.8 1.8.0 00-.18-.66 1.1 1.1.0 00-.438-.448q-.292-.165-.785-.166-.498.0-.803.189a1.4 1.4.0 00-.48.499 2 2 0 00-.231.696 5.6 5.6.0 00-.06.785v4.768h-2.35v-4.8q.002-.38-.018-.752a2.1 2.1.0 00-.143-.688 1.05 1.05.0 00-.415-.503c-.194-.125-.476-.19-.854-.19q-.168.0-.439.074c-.18.051-.36.143-.53.282a1.64 1.64.0 00-.439.595q-.18.39-.18 1.02v4.966H5.46V7.81zm15.693 15.64V.55H21.72V0H24v24h-2.28v-.55z"/></svg></a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base":"../..","features":["navigation.footer","navigation.instant","navigation.tracking","navigation.top","navigation.tabs","content.code.copy","content.action.view","content.action.edit","header.autohide"],"search":"../../assets/javascripts/workers/search.6ce7567c.min.js","translations":{"clipboard.copied":"Copied to clipboard","clipboard.copy":"Copy to clipboard","search.result.more.one":"1 more on this page","search.result.more.other":"# more on this page","search.result.none":"No matching documents","search.result.one":"1 matching document","search.result.other":"# matching documents","search.result.placeholder":"Type to start searching","search.result.term.missing":"Missing","select.version":"Select version"},"version":{"provider":"mike"}}</script><script src=../../assets/javascripts/bundle.83f73b43.min.js></script><script src=../../javascripts/wade.min.938547.min.js></script><script src=../../javascripts/search.d34b6a.min.js></script><script id=init-glightbox>const lightbox=GLightbox({touchNavigation:!0,loop:!1,zoomable:!0,draggable:!0,openEffect:"zoom",closeEffect:"zoom",slideEffect:"slide"});document$.subscribe(()=>{lightbox.reload()})</script>